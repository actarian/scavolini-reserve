!function(){"use strict";angular.module("artisan",["ng","ngRoute","ngMessages"])}(),function(){"use strict";var e=angular.module("artisan");e.factory("Color",[function(){function r(e,t,n,r){if(1<arguments.length)this.r=e||0===e?e:0,this.g=t||0===t?t:0,this.b=n||0===n?n:0,this.a=r||0===r?r:255;else{var o=e||"0xffffff";o=parseInt(o),8<e.length?(this.r=o>>24&255,this.g=o>>16&255,this.b=o>>8&255,this.a=o>>0&255):(this.r=o>>16&255,this.g=o>>8&255,this.b=o>>0&255,this.a=255)}}return r.componentToHex=function(e){var t=e.toString(16);return 1==t.length?"0"+t:t},r.luma=function(e){return e.dot({r:95,g:100,b:60})},r.contrast=function(e){return new r(.6<r.luma(e)?"0x000000":"0xffffff")},r.darker=function(e,t,n){return n=n||0,new r(Math.max(Math.floor(e.r*n),Math.floor(e.r-255*t)),Math.max(Math.floor(e.g*n),Math.floor(e.g-255*t)),Math.max(Math.floor(e.b*n),Math.floor(e.b-255*t)),e.a)},r.lighter=function(e,t,n){return n=n||1,new r(Math.min(e.r+Math.floor((255-e.r)*n),Math.floor(e.r+255*t)),Math.min(e.g+Math.floor((255-e.g)*n),Math.floor(e.g+255*t)),Math.min(e.b+Math.floor((255-e.b)*n),Math.floor(e.b+255*t)),e.a)},r.prototype={toUint:function(){return(this.r<<24)+(this.g<<16)+(this.b<<8)+this.a},toHex:function(){return"#"+r.componentToHex(this.r)+r.componentToHex(this.g)+r.componentToHex(this.b)+r.componentToHex(this.a)},toRgba:function(){return"rgba("+this.r+","+this.g+","+this.b+","+(this.a/255).toFixed(3)+")"},dot:function(e){return this.r/255*(e.r/255)+this.g/255*(e.g/255)+this.b/255*(e.b/255)},alpha:function(e,t,n){return t=t||0,n=n||1,this.a=Math.floor(255*(t+e*(n-t))),this},makeSet:function(){return this.foreground=r.contrast(this),this.border=r.darker(this,.3),this.light=r.lighter(this,.3),this}},r}]),e.factory("Shape",[function(){function n(){}return n.shapeCircle=function(e,t,n,r,o,i){o=o||0,i=i||2*Math.PI,e.ctx.arc(t,n,r,o,i,!1)},n.shapeStar=function(e,t,n,r,o,a){var s,u,c=Math.PI/2*3,l=Math.PI/a,f=e.ctx;for(f.moveTo(t,n-r),i=0;i<a;i++)s=t+Math.cos(c)*r,u=n+Math.sin(c)*r,f.lineTo(s,u),c+=l,s=t+Math.cos(c)*o,u=n+Math.sin(c)*o,f.lineTo(s,u),c+=l;f.lineTo(t,n-r)},n.shapeRoundRect=function(e,t,n){var r=e.ctx,o=t.x,i=t.y,a=t.w,s=t.h;if(void 0===typeof n&&(n=4),"number"==typeof n)n={tl:n,tr:n,br:n,bl:n};else{var u={tl:0,tr:0,br:0,bl:0};for(var c in u)n[c]=n[c]||u[c]}r.moveTo(o+n.tl,i),r.lineTo(o+a-n.tr,i),r.quadraticCurveTo(o+a,i,o+a,i+n.tr),r.lineTo(o+a,i+s-n.br),r.quadraticCurveTo(o+a,i+s,o+a-n.br,i+s),r.lineTo(o+n.bl,i+s),r.quadraticCurveTo(o,i+s,o,i+s-n.bl),r.lineTo(o,i+n.tl),r.quadraticCurveTo(o,i,o+n.tl,i)},n.circle=function(){var e=Array.prototype.slice.call(arguments),t=e[0].ctx;t.beginPath(),n.shapeCircle.apply(this,e),t.closePath()},n.star=function(){var e=Array.prototype.slice.call(arguments),t=e[0].ctx;t.beginPath(),n.shapeStar.apply(this,e),t.closePath()},n.roundRect=function(){var e=Array.prototype.slice.call(arguments),t=e[0].ctx;t.beginPath(),n.shapeRoundRect.apply(this,e),t.closePath()},n}]),e.constant("PainterColors",{black:"0x14191e",white:"0xffffff",blue:"0x0023FF",red:"0xF21500",lightBlue:"0x79ccf2",lightYellow:"0xfff79a",greyLighter:"0xf8f8f8",greyLight:"0xeeeeee",greyMedium:"0xcccccc",grey:"0x90939b",map:"0x24292e"}),e.factory("Palette",["$q","Painter","Rect",function(a,e,u){function t(){this.painter=(new e).setSize(0,0),this.buffer=(new e).setSize(0,0),this.size={w:0,h:0},this.pool={},this.rows={}}return t.prototype={getRect:function(e,t){var n=this.painter,r=this.size,o=this.rows,i=new u(0,0,e,t),a=o[t]||{x:0,y:r.h};if(r.w=Math.max(r.w,a.x+e),r.h=Math.max(r.h,a.y+t),n.canvas.width||n.canvas.height){if(r.w>n.canvas.width||r.h>n.canvas.height){var s=n.canvas;n.setCanvas(document.createElement("canvas")),n.setSize(r.w,r.h),n.ctx.drawImage(s,0,0)}}else n.setSize(r.w,r.h);return i.x=a.x,i.y=a.y,a.x+=e,o[t]=a,i},add:function(e,t){var n=this;if(angular.isString(t)){var r=a.defer(),o=new Image;return o.onload=function(){n.addShape(e,o.width,o.height,function(e,t){e.ctx.drawImage(o,0,0)}),r.resolve(o)},o.onerror=function(){r.reject("connot load "+t)},o.src=t,r.promise}var i=Array.prototype.slice.call(arguments);return n.addShape.apply(n,i)},addShape:function(e,t,n,r){var o=this.painter,i=this.getRect(t,n);o.ctx.save(),o.ctx.rect(i.x,i.y,i.w,i.h),o.ctx.clip(),o.ctx.translate(i.x,i.y),r.call(o,o,i.clone().setPos(0,0)),o.ctx.restore(),this.pool[e]=i},draw:function(e,t,n,r,o){var i=this.pool[t];i&&e.drawRect(this.painter.canvas,i,{x:n,y:r,w:i.w,h:i.h},o)},tint:function(e,t,n,r,o,i){var a=this.pool[t];if(a){var s=this.painter,u=this.buffer.setSize(a.w,a.h);u.save(),u.setFill(o),u.fillRect(),u.ctx.globalCompositeOperation="destination-atop",u.ctx.drawImage(s.canvas,a.x,a.y,a.w,a.h,0,0,a.w,a.h),u.restore(),console.log(n,r,u.canvas,e.canvas),e.draw(u.canvas,{x:n,y:r},i)}},pattern:function(n,e,r,o,i,a,t){function s(e){var t=n.ctx;t.save(),t.translate(r,o),t.fillStyle=e,t.fillRect(-r,-o,i,a),t.translate(-r,-o),t.restore()}var u=this.pool[e];if(u){var c=u.img;if(c&&u.color==t)s(n.ctx.createPattern(c,"repeat"));else{var l=this.buffer.setSize(u.w,u.h);t?(u.color=t,l.save(),l.setFill(t),l.fillRect(),l.ctx.globalCompositeOperation="destination-atop",l.ctx.drawImage(this.painter.canvas,u.x,u.y,u.w,u.h,0,0,u.w,u.h),l.restore()):l.ctx.drawImage(this.painter.canvas,u.x,u.y,u.w,u.h,0,0,u.w,u.h),(c=new Image).onload=function(){u.img=c,s(n.ctx.createPattern(c,"repeat"))},c.src=l.toDataURL()}}}},t}]),e.factory("Painter",["Shape","Rect","Color","PainterColors",function(e,t,r,o){function n(e){e=e||document.createElement("canvas"),this.rect=new t,this.drawingRect=new t,this.setColors(),this.setCanvas(e)}n.colors={},angular.forEach(o,function(e,t){n.colors[t]=new r(e).makeSet()});return n.prototype={colors:n.colors,setColors:function(){var n=this.colors;angular.forEach(o,function(e,t){n[t]=new r(e).makeSet()})},setCanvas:function(e){this.canvas=e,this.setSize(e.offsetWidth,e.offsetHeight);var t=e.getContext("2d");return t.lineCap="square",this.ctx=t,this},setSize:function(e,t){return this.canvas.width=e,this.canvas.height=t,this.rect.w=e,this.rect.h=t,this},copy:function(e){return this.ctx.drawImage(e,0,0),this},clear:function(){return this.resize(),this},resize:function(){return this.setSize(this.canvas.offsetWidth,this.canvas.offsetHeight),this},setText:function(e,t,n,r){e=e||"11px monospace",t=t||"center",n=n||"middle",r=r||this.colors.black;var o=this.ctx;return o.font=e,o.textAlign=t,o.textBaseline=n,o.fillStyle=r.toRgba(),this},setFill:function(e){return e=e||this.colors.black,this.ctx.fillStyle=e.toRgba(),this},setStroke:function(e,t){e=e||this.colors.black;var n=this.ctx;return t=t||1,n.strokeStyle=e.toRgba(),n.lineWidth=t,this},fillText:function(e,t,n,r,o){return n&&(r=r||"",o=o||Math.floor(n/8),e.length>o&&(e=e.substr(0,Math.min(e.length,o)).trim()+r)),this.ctx.fillText(e,t.x,t.y),this},fillRect:function(e){e=e||this.rect;var t=this.ctx,n=e.x,r=e.y,o=e.w,i=e.h;return t.fillRect(n,r,o,i),this},strokeRect:function(e){e=e||this.rect;var t=this.ctx,n=e.x,r=e.y,o=e.w,i=e.h;return t.strokeRect(n,r,o,i),this},fill:function(){return this.ctx.fill(),this},stroke:function(){return this.ctx.stroke(),this},begin:function(){return this.ctx.beginPath(),this},close:function(){return this.ctx.closePath(),this},save:function(){return this.ctx.save(),this},restore:function(){return this.ctx.restore(),this},rotate:function(e){this.ctx.rotate(e*Math.PI/180)},translate:function(e){this.ctx.translate(e.x,e.y)},toDataURL:function(){return this.canvas.toDataURL()},draw:function(e,t,n){if(e){t.w=t.w||e.width,t.h=t.h||e.height;var r=this.ctx,o=this.drawingRect,i=o.x=t.x-t.w/2,a=o.y=t.y-t.h/2;o.w=t.w,o.h=t.h;r.save(),r.translate(i,a),n&&n.call(this),r.drawImage(e,0,0),r.restore()}return this},drawRect:function(e,t,n,r){if(e){t.w=t.w||e.width,t.h=t.h||e.height,n.w=n.w||e.width,n.h=n.h||e.height;var o=this.ctx,i=this.drawingRect,a=i.x=n.x-t.w/2,s=i.y=n.y-t.h/2;i.w=n.w,i.h=n.h;o.save(),o.translate(a,s),r&&r.call(this),o.drawImage(e,t.x,t.y,t.w,t.h,0,0,n.w,n.h),o.restore()}return this},flip:function(e){e=e||{x:1,y:-1};var t=this.ctx,n=this.drawingRect;t.translate(-1===e.x?n.w:0,-1===e.y?n.h:0),t.scale(e.x,e.y)}},n}])}(),function(){"use strict";angular.module("artisan").directive("expandable",["$parse","State","Dom",function(R,A,I){return{restrict:"A",link:function(e,t,n,r){var o,i,a,s,u,c,l,f,h,d,g=new A;g.pow=0;var m=!1,p=document.createElement("div");function y(e,t){var n,r;e.style.cssText=(n=t,r="",angular.forEach(n,function(e,t){r+=t+": "+e+"; "}),r)}function v(){var e,t;e=a,t=window.getComputedStyle(e,null),h={display:t.getPropertyValue("display"),position:t.getPropertyValue("position"),width:t.getPropertyValue("width"),height:t.getPropertyValue("height"),top:t.getPropertyValue("top"),right:t.getPropertyValue("right"),bottom:t.getPropertyValue("bottom"),left:t.getPropertyValue("left"),"margin-top":t.getPropertyValue("margin-top"),"margin-right":t.getPropertyValue("margin-right"),"margin-bottom":t.getPropertyValue("margin-bottom"),"margin-left":t.getPropertyValue("margin-left"),"padding-top":t.getPropertyValue("padding-top"),"padding-right":t.getPropertyValue("padding-right"),"padding-bottom":t.getPropertyValue("padding-bottom"),"padding-left":t.getPropertyValue("padding-left"),"background-color":t.getPropertyValue("background-color")},y(p,h),a.parentNode.insertBefore(p,a),d=a.style.cssText,s.addClass("expandable-expanding"),I.getParents(a).each(function(e,t){e.addClass("expandable-parent")})}function w(){if(f=s&&s.hasClass("expandable-expanding")?p.getBoundingClientRect():a.getBoundingClientRect(),u={top:0,left:0,width:f.width,height:f.height},c={top:0+(o.top||0),left:0+(o.left||0),width:u.width+(o.right||0),height:u.height+(o.bottom||0)},i.top&&(c.top=i.top-f.top),i.left&&(c.left=i.left-f.left),i.right){var e=window.innerWidth-i.right,t=f.left+c.left;c.width=e-t}if(i.bottom){var n=window.innerHeight-i.bottom,r=f.top+c.top;c.height=n-r}}function x(){m?g.idle():(w(),v(),l=angular.copy(u),y(a,u),dynamics.animate(g,{pow:1},{type:dynamics.easeInOut,duration:350,complete:function(){m=!0,g.idle()},change:function(){k()}}))}function b(){m?dynamics.animate(g,{pow:0},{type:dynamics.easeInOut,duration:350,complete:function(){m=!1,a.style.cssText=d,s.removeClass("expandable-expanding"),p.parentNode.removeChild(p),I.getParents(a).each(function(e,t){e.removeClass("expandable-parent")}),g.idle()},change:function(){k()}}):g.idle()}function k(){l.left=u.left+(c.left-u.left)*g.pow+"px",l.top=u.top+(c.top-u.top)*g.pow+"px",l.width=u.width+(c.width-u.width)*g.pow+"px",l.height=u.height+(c.height-u.height)*g.pow+"px",y(a,l)}function M(){o=n.expandableRelative?R(n.expandableRelative)(e):{},i=n.expandableAbsolute?R(n.expandableAbsolute)(e):{},(a=t[0].querySelector(n.expandable))&&(s=angular.element(a))}function $(e){M(),a&&x()}function E(e){I.getClosestNode(e.target,t[0])||(M(),a&&b())}function D(e){(m||g.isBusy)&&(w(),k())}function T(e){var t=e.key.toLowerCase();switch(t){case"escape":M(),a&&b();break;case"enter":M(),a&&a.tagName&&"input"===a.tagName.toLowerCase()&&b()}}angular.element(p).addClass("expandable-placeholder");var S=n.expandableTrigger?t[0].querySelector(n.expandableTrigger):null;S=S?angular.element(S):t,e.$on("$destroy",function(){S.off("mousedown touchstart",$),t.off("keydown",T),angular.element(window).off("click",E).off("resize",D)}),S.on("mousedown touchstart",$),t.on("keydown",T),angular.element(window).on("click",E).on("resize",D)}}}])}(),function(){"use strict";var e=angular.module("artisan");e.directive("controlMessages",[function(){return{restrict:"E",templateUrl:"artisan/components/forms/partial/messages",transclude:{message:"?messageItems"},link:function(e,t,n,r){}}}]),e.directive("control",["$parse",function(l){var f=0;return{restrict:"A",templateUrl:function(e,t){var n="artisan/components/forms/partial/text";switch(t.control){case"select":n="artisan/components/forms/partial/select"}return n},scope:{ngModel:"=",required:"=",form:"@",title:"@",placeholder:"@",source:"=?",key:"@?",label:"@?"},require:"ngModel",transclude:!0,link:{pre:function(n,e,t,r,o){var i=n.label=n.label?n.label:"name",a=n.key=n.key?n.key:"id";if("select"===t.control){var s=t.filter?"| "+t.filter:"",u=function(e,n,r){n=n||"";var t=(e=e||"").split(",");if(1<t.length){var o=t.shift();return angular.forEach(t,function(e,t){o=r?o.split("{"+t+"}").join("' + "+n+e+" + '"):o.split("{"+t+"}").join(n+e)}),r?"'"+o+"'":o}return n+e}(i,"item.",!0);n.getOptions=function(){return t.number?"item."+a+" as "+u+" disable when item.disabled for item in source "+s:u+" disable when item.disabled for item in source "+s+" track by item."+a}}n.type=t.control,n.form=n.form||"form";var c=n.title=n.title||"untitled";n.placeholder=n.placeholder||c,n.field=c.replace(/[^0-9a-zA-Z]/g,"").split(" ").join("")+ ++f;n.format=t.format||null,n.precision=t.precision||null,n.validate=t.validate||t.control,n.minLength=t.minLength||0,n.maxLength=t.maxLength||Number.POSITIVE_INFINITY,n.min=t.min||null,n.max=t.max||null,n.options=l(t.options)(n)||{},n.focus=!1,n.visible=!1,n.onChange=function(e){l(t.onChange)(n.$parent)},n.onFilter=function(e){l(t.onFilter)(n.$parent)},n.getType=function(){var e="text";switch(t.control){case"password":e=n.visible?"text":"password";break;default:e=t.control}return e},n.getClasses=function(){var e=l(n.form)(n.$parent),t=l(n.form+"."+n.field)(n.$parent);return{"control-focus":n.focus,"control-success":t.$valid,"control-error":t.$invalid&&(e.$submitted||t.$touched),"control-empty":!t.$viewValue}},n.getMessages=function(){var e=l(n.form)(n.$parent),t=l(n.form+"."+n.field)(n.$parent);return(e.$submitted||t.$touched)&&t.$error},n.toggleVisibility=function(){n.visible=!n.visible}}}}}]),e.directive("_control",["$http","$templateCache","$compile","$parse",function(e,t,n,u){var c=0;return{restrict:"A",templateUrl:function(e,t){var n="artisan/components/forms/partial/text";switch(t.control){case"select":n="artisan/components/forms/partial/select"}return n},scope:{ngModel:"=",required:"=",form:"@",title:"@",placeholder:"@"},require:"ngModel",compile:function(e,t){return{pre:function(n,e,t){if("select"===t.control){var r=t.label?t.label:"name",o=t.key?t.key:"id",i=t.min?" | filter:gte('"+o+"', "+t.min+")":"",a=function(e,n,r){n=n||"";var t=(e=e||"").split(",");if(1<t.length){var o=t.shift();return angular.forEach(t,function(e,t){o=r?o.split("{"+t+"}").join("' + "+n+e+" + '"):o.split("{"+t+"}").join(n+e)}),r?"'"+o+"'":o}return n+e}(r,"item.",!0);n.options=t.number?"item."+o+" as "+a+" disable when item.disabled for item in "+t.source+i:a+" disable when item.disabled for item in "+t.source+i+" track by item."+o,console.log("control.compile.pre",n.options)}n.type=t.control,n.form=n.form||"form";var s=n.title=n.title||"untitled";n.placeholder=n.placeholder||s,n.field=s.replace(/[^0-9a-zA-Z]/g,"").split(" ").join("")+ ++c;n.validate=t.validate||t.control,n.format=t.format||null,n.precision=t.precision||null,n.validate=t.validate||t.control,n.minLength=t.min||0,n.maxLength=t.max||Number.POSITIVE_INFINITY,n.options=u(t.options)(n)||{},n.focus=!1,n.visible=!1,n.getType=function(){var e="text";switch(t.control){case"password":e=n.visible?"text":"password";break;default:e=t.control}return e},n.getClasses=function(){var e=u(n.form)(n.$parent),t=u(n.form+"."+n.field)(n.$parent);return{"control-focus":n.focus,"control-success":t.$valid,"control-error":t.$invalid&&(e.$submitted||t.$touched),"control-empty":!t.$viewValue}},n.getMessages=function(){var e=u(n.form)(n.$parent),t=u(n.form+"."+n.field)(n.$parent);return(e.$submitted||t.$touched)&&t.$error}}}}}}]),e.directive("numberPicker",["$parse","$timeout",function(c,l){return{restrict:"A",template:'<div class="input-group">   <span class="input-group-btn"><button class="btn btn-outline-primary" type="button">-</button></span>   <div ng-transclude></div>   <span class="input-group-btn"><button class="btn btn-outline-primary" type="button">+</button></span></div>',replace:!0,transclude:!0,link:function(o,e,i,t){var n=e[0],r=n.querySelectorAll(".input-group-btn > .btn")[0],a=n.querySelectorAll(".input-group-btn > .btn")[1];function s(e){var t=c(i.min)(o),n=c(i.numberPicker),r=n.assign;l(function(){r(o,Math.max(t,n(o)-1))})}function u(e){var t=c(i.max)(o),n=c(i.numberPicker),r=n.assign;l(function(){r(o,Math.min(t,n(o)+1))})}o.$on("$destroy",function(){angular.element(r).off("touchstart mousedown",s),angular.element(a).off("touchstart mousedown",u)}),angular.element(r).on("touchstart mousedown",s),angular.element(a).on("touchstart mousedown",u)}}}])}(),function(){"use strict";angular.module("artisan").directive("validate",["$filter",function(c){return{require:"ngModel",link:function(e,t,n,r){var o=n.validate,i=n.format||"",a=n.precision||2;switch(o){case"date":case"datetime":case"datetime-local":r.$formatters.push(function(e){return e?c("date")(e,i):null});break;case"number":r.$parsers.unshift(function(e){var t=!1;return void 0!==e&&""!==e?(t=-1!==String(e).indexOf(Number(e).toString()),e=Number(e),r.$setValidity("number",t),t&&(r.$setValidity("positive",.01<=e),void 0!==n.min&&r.$setValidity("range",e>=Number(n.min)),void 0!==n.max&&r.$setValidity("range",e<=Number(n.max)))):(t=!0,e=Number(e),r.$setValidity("number",!0),r.$setValidity("positive",!0),void 0!==n.min&&r.$setValidity("range",!0),void 0!==n.max&&r.$setValidity("range",!0)),e}),r.$formatters.push(function(e){return e?c("number")(e,a)+" "+i:null});break;case"anynumber":r.$parsers.unshift(function(e){var t=!1;return void 0!==e&&""!==e?(t=-1!==String(e).indexOf(Number(e).toString()),e=Number(e),r.$setValidity("number",t),t&&(void 0!==n.min&&r.$setValidity("range",e>=Number(n.min)),void 0!==n.max&&r.$setValidity("range",e<=Number(n.max)))):(t=!0,e=Number(e),r.$setValidity("number",!0),void 0!==n.min&&r.$setValidity("range",!0),void 0!==n.max&&r.$setValidity("range",!0)),e}),r.$formatters.push(function(e){return e||0===e?c("number")(e,a)+" "+i:null})}function s(){!0,i&&(t[0].value=r.$modelValue||null,r.$modelValue||r.$setViewValue(null))}function u(){!1,function(){if(i&&!r.$invalid)switch(o){case"date":case"datetime":case"datetime-local":t[0].value=r.$modelValue?c("date")(r.$modelValue,i):" ";break;default:t[0].value=r.$modelValue?c("number")(r.$modelValue,a)+" "+i:" "}}()}e.$on("$destroy",function(){t.off("focus",s),t.off("blur",u)}),t.on("focus",s),t.on("blur",u)}}}])}(),function(){"use strict";angular.module("artisan").directive("modalView",["$parse","$templateRequest","$compile","$controller","Dom",function(i,a,s,u,e){return{restrict:"A",priority:-400,link:function(t,n,e,r){var o=i(e.modalView);(o=o(t)).templateUrl=o.templateUrl||"artisan/components/modals/partial/modal",a(o.templateUrl).then(function(e){!function(e,t,n,r){t.html(n);var o=s(t.contents());if(r.controller){var i=e.$new();angular.extend(i,r);var a=u(r.controller,{$scope:i});r.controllerAs&&(e[r.controllerAs]=a),t.data("$ngControllerController",a),t.children().data("$ngControllerController",a),e=i}o(e)}(t,n,e,o)})}}}])}(),function(){"use strict";angular.module("artisan").provider("$modal",[function(){var u,c=[],l={};this.modals=c,this.routes=l,this.when=function(e,t){return l[e]=t,this},this.$get=["$q","$timeout",function(i,a){function s(n){var r=-1;angular.forEach(c,function(e,t){e===n&&(r=t)}),-1!==r&&(n.active=!1,u&&a.cancel(u),u=a(function(){for(;c.length;)c.splice(c.length-1,1)},0))}return{modals:c,addModal:function(e,t){var n=i.defer(),o={title:"Untitled",controller:null,templateUrl:null,params:t=t||null},r=l[e];return r&&angular.extend(o,r),o.deferred=n,o.back=function(e){var n,r;n=this,r=-1,angular.forEach(c,function(e,t){e===n&&(r=t)}),-1!==r&&(u&&a.cancel(u),u=a(function(){n.active=!1,c.splice(r,1),c.length&&(c[c.length-1].active=!0)},0)),o.deferred.resolve(e,o)},o.resolve=function(e){s(this),o.deferred.resolve(e,o)},o.reject=function(){s(this),o.deferred.reject(o)},angular.forEach(c,function(e,t){e.active=!1}),c.length?(c.push(o),o.active=!0):(c.push(o),u&&a.cancel(u),u=a(function(){o.active=!0},50)),n.promise}}}]}])}(),function(){"use strict";var e=angular.module("artisan");e.directive("nav",["$parse","Nav",function(a,s){return{restrict:"A",templateUrl:function(e,t){return t.template||"artisan/components/nav/partial/nav"},scope:{items:"=nav"},link:function(o,e,i,t){o.$watch("items",function(e){if(e)if(angular.isArray(e)){var t=a(i.onPath)(o.$parent),n=a(i.onNav)(o.$parent),r=new s({onPath:t,onNav:n});r.setItems(e),o.item=r}else e instanceof s&&(o.item=e)})}}}]),e.directive("navItem",["$timeout","Events",function(c,l){return{restrict:"A",templateUrl:function(e,t){return t.template||"artisan/components/nav/partial/nav-item"},scope:{item:"=navItem"},link:function(o,e,t,n){var i,r=angular.element(e[0].querySelector(".nav-link"));function a(e,t){var n=e.$nav.state;n.active=!1,c(function(){n.immediate=t,n.opened=n.opening=!1,n.closing=!0,c(function(){n.closing=!1,n.closed=!0})}),e.items&&angular.forEach(e.items,function(e){a(e,!0)})}function s(t){var e,n,r=t.$nav.state;r.active=!t.items||!r.active,r.active?(t.$nav.parent&&angular.forEach(t.$nav.parent.items,function(e){e!==t&&a(e,!0)}),(n=t.$nav.state).active=!0,c(function(){n.immediate=e,n.closed=n.closing=!1,n.opening=!0,c(function(){n.opening=!1,n.opened=!0})})):a(t)}function u(e){if(!1===i)return e.stop(),!1}new l(r).add({down:function(e){var t=o.item;if(t.$nav.state.active)i=!1,r();else if(t.$nav.onNav){var n=t.$nav.onNav(t,t.$nav);n&&"function"==typeof n.then?(n.then(function(e){r()},function(e){}),i=!1):(i=n,r())}function r(){c(function(){s(t)})}},click:function(e){return u(e)}},o)}}}]),e.directive("navTo",["$parse","$timeout","Events",function(r,o,i){return{restrict:"A",link:function(t,e,n){new i(e).add({down:function(e){return console.log("navTo.onDown",n.navTo),o(function(){r(n.navTo)(t)}),e.preventDefault(),!1}},t)}}}])}(),function(){"use strict";angular.module("artisan").factory("Nav",["Silent",function(t){function e(e){angular.extend(this,{items:[]}),e&&angular.extend(this,e),this.setNav(this,null)}var n={silent:function(e){t.silent(e)},path:function(e){t.path(e)}},r={addItem:function(e,t){this.onPath,this.onNav;this.setNav(e,t),t&&(t.items=t.items||[],t.items.push(e))},addItems:function(e,t){var n=this;angular.isArray(e)?angular.forEach(e,function(e){n.addItem(e,t)}):n.addItem(e,t)},getPath:function(e){var t=null;t=this.onPath?this.onPath(e,e.$nav):e.path;return t},setItems:function(e){this.path=t.path(),this.items=e,this.setNavs(e,this)},setNav:function(t,e){var n=this,r={parent:e||null,level:e?e.$nav.level+1:0,state:{},addItems:function(e){n.addItems(e,t)},onNav:n.onNav};if((t.$nav=r).path=n.getPath(t),r.path===n.path)for(r.state.active=!0,r.state.opened=!0;r.parent;)(r=r.parent.$nav).state.active=!0,r.state.opened=!0},setNavs:function(e,t){var n=this;e&&angular.forEach(e,function(e){n.setNav(e,t),n.setNavs(e.items,e)})}};return angular.extend(e,n),angular.extend(e.prototype,r),e}])}(),function(){"use strict";angular.module("artisan").directive("popuppable",["$parse","State","Dom",function(e,x,b){return{restrict:"A",link:function(e,t,n,r){var o,i,a,s,u,c=new x;c.pow=0;var l=!1;function f(e,t){var n,r;e.style.cssText=(n=t,r="",angular.forEach(n,function(e,t){r+=t+": "+e+"; "}),r)}function h(){l?c.idle():(i.addClass("popuppable-opening"),b.getParents(o).each(function(e,t){e.addClass("popuppable-parent")}),u=angular.copy(a),dynamics.animate(o,{opacity:1,scale:1},{type:dynamics.spring,frequency:200,friction:270,duration:800,complete:function(){l=!0,c.idle()}}))}function d(){l?dynamics.animate(o,{opacity:0,scale:.1},{type:dynamics.easeInOut,duration:300,friction:100,complete:function(){l=!1,i.removeClass("popuppable-opening"),b.getParents(o).each(function(e,t){e.removeClass("popuppable-parent")}),c.idle()}}):c.idle()}function g(){(o=t[0].querySelector(n.popuppable))&&(i=angular.element(o)).addClass("popuppable-target")}function m(e){g(),o&&h()}function p(e){b.getClosestNode(e.target,t[0])||(g(),o&&d())}function y(e){(l||c.isBusy)&&(u.left=a.left+(s.left-a.left)*c.pow+"px",u.top=a.top+(s.top-a.top)*c.pow+"px",u.width=a.width+(s.width-a.width)*c.pow+"px",u.height=a.height+(s.height-a.height)*c.pow+"px",f(o,u))}function v(e){var t=e.key.toLowerCase();switch(t){case"escape":g(),o&&d();break;case"enter":g(),o&&o.tagName&&"input"===o.tagName.toLowerCase()&&d()}}e.$on("$destroy",function(){var e;((e=t[0].querySelector(".popuppable-trigger"))?angular.element(e):t).off("mousedown touchstart",m).off("keydown",v),angular.element(window).off("click",p).off("resize",y)}),w=t[0].querySelector(".popuppable-trigger"),(w?angular.element(w):t).on("mousedown touchstart",m).on("keydown",v),angular.element(window).on("click",p).on("resize",y),g();var w}}}])}(),function(){"use strict";window.ondragstart=function(){return!1};var e=angular.module("artisan");e.directive("scrollableX",["$parse","$compile","$timeout","Scrollable","Animate","Style","Events","Utils",function(k,e,t,M,$,E,D,n){return{restrict:"A",template:'<div class="scrollable-content" ng-transclude></div>',transclude:!0,link:function(t,e,n,r){var o,i,a;n.onLeft&&(o=k(n.onLeft)),n.onRight&&(i=k(n.onRight)),n.showIndicatorFor&&k(n.showIndicatorFor),n.scrollableWhen&&(a=k(n.scrollableWhen)),e.attr("unselectable","on").addClass("unselectable");var s,u=e[0],c=u.querySelector(".scrollable-content"),l=angular.element(l),f=new E,h=new $(g),d=n.scrollableX?k(n.scrollableX)(t):new M;function g(e){d.setContainer(u),d.setContent(c),d.setEnabled(v());d.renderX();var t=d.getCurrent();f.transform("translate3d("+t.x.toFixed(2)+"px,0,0)"),f.set(c)}function m(e){d.dragMove(e.absolute);var t=d.getDrag();Math.abs(t.y)>Math.abs(t.x)?p(e):e.stop()}function p(e){d.dragEnd(e.absolute),e.stop(),b()}(s=d).link({getItems:function(){if(n.scrollableItem){var e=u.querySelectorAll(n.scrollableItem);return e}},prev:function(){s.scrollPrev(),h.play()},next:function(){s.scrollNext(),h.play()},reset:function(){s.doReset(),h.play()},onLeft:o,onRight:i});var y=function(e,t){return d.wheelX(e,t)};function v(){var e=!0;return a&&(e=e&&a(t)),e=(e=e&&1024<=window.innerWidth)&&u.offsetWidth<c.offsetWidth}function w(){v()||(b(),d.off()),g()}t.$watch(function(){return c.offsetWidth},function(e,t){w()});new D(e).add({down:function(e){d.dragStart(e.absolute)&&(x.add({move:m,up:p},t),h.play(),e.stop())},wheel:function(e){d.wheelXCheck(e.dir)&&(y(e.dir,e.interval),h.play(),e.stop())}},t);var x=new D(window).add({resize:w},t);function b(){x.remove({move:m,up:p})}t.$on("$destroy",function(){h.pause()})}}}]),e.directive("scrollableY",["$parse","$compile","$timeout","Scrollable","Animate","Style","Events","Utils",function(k,e,t,M,$,E,D,n){return{restrict:"A",template:'<div class="scrollable-content" ng-transclude></div>',transclude:!0,link:function(t,e,n,r){var o,i,a;n.onTop&&(o=k(n.onTop)),n.onBottom&&(i=k(n.onBottom)),n.showIndicatorFor&&k(n.showIndicatorFor),n.scrollableWhen&&(a=k(n.scrollableWhen)),e.attr("unselectable","on").addClass("unselectable");var s,u=e[0],c=u.querySelector(".scrollable-content"),l=angular.element(l),f=new E,h=new $(g),d=n.scrollableY?k(n.scrollableY)(t):new M;function g(e){d.setContainer(u),d.setContent(c),d.setEnabled(v());d.renderY();var t=d.getCurrent();f.transform("translate3d(0,"+t.y.toFixed(2)+"px,0)"),f.set(c)}function m(e){d.dragMove(e.absolute);var t=d.getDrag();Math.abs(t.x)>Math.abs(t.y)?p(e):e.stop()}function p(e){d.dragEnd(e.absolute),e.stop(),b()}(s=d).link({getItems:function(){if(n.scrollableItem){var e=u.querySelectorAll(n.scrollableItem);return e}},prev:function(){s.scrollPrev(),h.play()},next:function(){s.scrollNext(),h.play()},reset:function(){s.doReset(),h.play()},onTop:o,onBottom:i});var y=function(e,t){return d.wheelY(e,t)};function v(){var e=!0;return a&&(e=e&&a(t)),e=(e=e&&1024<=window.innerWidth)&&u.offsetHeight<c.offsetHeight}function w(){v()||(b(),d.off()),g()}t.$watch(function(){return c.offsetHeight},function(e,t){w()});new D(e).add({down:function(e){d.dragStart(e.absolute)&&(x.add({move:m,up:p},t),h.play(),e.stop())},wheel:function(e){d.wheelYCheck(e.dir)&&(y(e.dir,e.interval),h.play(),e.stop())}},t);var x=new D(window).add({resize:w},t);function b(){x.remove({move:m,up:p})}t.$on("$destroy",function(){h.pause()})}}}])}(),function(){"use strict";angular.module("artisan").factory("Scrollable",["Utils","Point","Rect",function(e,P,O){function t(){var t,n,r,o,i,a,s,u,c=150,l=0;n=!0;var f=new P,h=new P,d=new P,g=new P,e=new P,m=new P,p=new P,y=new O,v=new O,w=new O,x={start:f,end:h,current:d,indicator:e,speed:p,overflow:w,container:y,content:v,setContainer:function(e){y.width=e.offsetWidth,y.height=e.offsetHeight},setContent:function(e){v.width=e.offsetWidth,v.height=e.offsetHeight},setEnabled:function(e){t=e},getCurrent:function(){return d},getDrag:function(){return g},getIndicator:function(){return e},getIndex:function(){return l},scrollToIndex:b,scrollPrev:function(){var e=Math.max(0,l-1);console.log("scrollPrev",e),b(e)},scrollNext:function(){var e=x.getItems(),t=Math.min(e.length-1,l+1);console.log("scrollNext",t),b(t)},dragStart:function(e){return!r&&(f.x=h.x=d.x,f.y=h.y=d.y,p.x=0,p.y=0,a=e,!(i=!(l=-1)))},dragMove:function(e){u=s,s=e,g.x=s.x-a.x,g.y=s.y-a.y,o=!0},dragEnd:function(){s&&u&&(p.x+=4*(s.x-u.x),p.y+=4*(s.y-u.y));f.x=h.x=d.x,f.y=h.y=d.y,o=!1,u=a=s=null},doReset:function(){h.x=d.x=0},off:k,doLeft:M,doRight:$,renderX:function(){var e=!0;t?(w.x=0,w.width=y.width-v.width,o?(h.x=f.x+s.x-a.x,E()&&(f.x=h.x,a.x=s.x)):p.x?(h.x+=p.x,p.x*=.75,i&&E(),Math.abs(p.x)<2.05&&(p.x=0,x.wheeling=i=!1,D())):m&&(h.x=-m.x,m=null),h.x=Math.round(1e4*h.x)/1e4,h.x=Math.min(w.x,h.x),h.x=Math.max(w.width,h.x),d.x+=(h.x-d.x)/4,0===p.x&&Math.abs(h.x-d.x)<.05&&(d.x=h.x,D()||(e=!1))):(d.x=h.x=0,e=!1);return e},scrollToX:T,wheelX:function(e,t){h.x+=100*e/1e3*t,p.x+=100*e/1e3*t,i=!0},wheelXCheck:function(e){return!(r||!t)&&(e<0?h.x-w.width:h.x-w.x)},doTop:S,doBottom:R,renderY:function(){var e=!0;t?(w.y=0,w.height=y.height-v.height,o?(h.y=f.y+s.y-a.y,A()&&(f.y=h.y,a.y=s.y)):p.y?(h.y+=p.y,p.y*=.75,i&&A(),Math.abs(p.y)<2.05&&(p.y=0,x.wheeling=i=!1,I())):m&&(h.y=-m.y,m=null),h.y=Math.round(1e4*h.y)/1e4,h.y=Math.min(w.y,h.y),h.y=Math.max(w.height,h.y),d.y+=(h.y-d.y)/4,0===p.y&&Math.abs(h.y-d.y)<.05&&(d.y=h.y,I()||(e=!1))):(d.y=h.y=0,e=!1);return e},scrollToY:C,wheelY:function(e,t){h.y+=100*e/1e3*t,p.y+=100*e/1e3*t,i=!0},wheelYCheck:function(e){return!(r||!t)&&(e<0?h.y-w.height:h.y-w.y)}};function b(e){if(e!==l){var t=function(e){var t=null,n=x.getItems();n&&0<=e&&e<n.length&&(t=n[e]);return t}(l=e);return t&&(m=new P(t.offsetLeft,t.offsetTop)),!0}}function k(){i=o=!1,a=s=null}function M(e){r||x.onLeft&&(r=!0,x.onLeft(e).then().finally(function(){T(0)}))}function $(e){r||x.onRight&&(r=!0,x.onRight(e).then().finally(function(){y.width-v.width>w.width?f.x=h.x=w.width:f.x=h.x=w.width+c,T(0)}))}function E(){var e=!1;return w.x+=c,w.width-=c,h.x>w.x?(e=!0,M()):h.x<w.width&&(e=!0,$()),e}function D(){var e=x.getItems();if(e){var r=-1,o=Number.POSITIVE_INFINITY;if(angular.forEach(e,function(e,t){var n=Math.abs(h.x+p.x- -1*e.offsetLeft);n<o&&(o=n,r=t)}),-1!==r){if(n)return b(r);l=r}}}function T(e){f.x=h.x=e,setTimeout(function(){k(),r=!1},500)}function S(e){r||x.onTop&&(r=!0,x.onTop(e).then().finally(function(){C(0)}))}function R(e){r||x.onBottom&&(r=!0,x.onBottom(e).then().finally(function(){y.height-v.height>w.height?f.y=h.y=w.height:f.y=h.y=w.height+c,C(0)}))}function A(){var e=!1;return w.y+=c,w.height-=c,h.y>w.y?(e=!0,S()):h.y<w.height&&(e=!0,R()),e}function I(){var e=x.getItems();if(e){var r=-1,o=Number.POSITIVE_INFINITY;if(angular.forEach(e,function(e,t){var n=Math.abs(h.y+p.y- -1*e.offsetTop);n<o&&(o=n,r=t)}),-1!==r){if(n)return b(r);l=r}}}function C(e){f.y=h.y=e,setTimeout(function(){k(),r=!1},500)}angular.extend(this,x),x=this}return t.prototype={link:function(e){angular.extend(this,e)},getItems:function(){return[content]}},t}])}(),function(){"use strict";angular.module("artisan").directive("videoSource",["$timeout","$promise",function(d,g){return{restrict:"A",scope:{source:"=videoSource",image:"=videoImage"},templateUrl:function(e,t){return t.template||"artisan/components/video/partial/video-player"},link:function(r,e,t){var n=e[0],o=n.querySelector("video"),i=(n.querySelector("img"),{});function a(){return g(function(n){r.canplay?n.resolve():(angular.element(o).on("canplay",function e(t){r.canplay=!0;angular.element(o).off("canplay",e);n.resolve()}),o.preload=!0,o.src=r.source)})}function s(e){d(function(){r.playing=!0,r.busy=!1})}function u(e){d(function(){r.playing=!1,r.busy=!1})}function c(e){d(function(){r.playing=!1,r.busy=!1})}function l(e){d(function(){i.buffered=o.buffered})}function f(e){d(function(){i.duration=o.duration,i.currentTime=o.currentTime,i.progressTime=i.currentTime/i.duration})}r.canplay=!1,r.playing=!1,r.busy=!1,r.toggle=function(){r.busy||(r.busy=!0,r.playing?o.pause():a().then(function(){o.play()}))},r.play=function(){r.busy||(r.busy=!0,a().then(function(){o.play()}))},r.pause=function(){r.busy||(r.busy=!0,o.pause())},r.infos=i;var h=angular.element(o);h.on("playing",s),h.on("pause",u),h.on("ended",c),h.on("progress",l),h.on("timeupdate",f),r.$on("destroy",function(){h.off("playing",s),h.off("pause",u),h.off("ended",c),h.off("progress",l),h.off("timeupdate",f)})}}}])}(),function(){"use strict";angular.module("artisan").factory("Animate",[function(){function e(e){this.callback=e,this.key=null,this.ticks=0}var t={pause:function(){this.key&&(window.cancelAnimationFrame(this.key),this.key=null)},play:function(){var n=this;n.key||function e(t){n.ticks++;n.callback(t,n.ticks);n.key=window.requestAnimationFrame(e)}()},toggle:function(){this.key?this.pause():this.play()}};return angular.extend(e,{}),angular.extend(e.prototype,t),e}]),function(){for(var i=0,e=["ms","moz","webkit","o"],t=0;t<e.length&&!window.requestAnimationFrame;++t)window.requestAnimationFrame=window[e[t]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e[t]+"CancelAnimationFrame"]||window[e[t]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(e,t){var n=(new Date).getTime(),r=Math.max(0,16-(n-i)),o=window.setTimeout(function(){e(n+r)},r);return i=n+r,o}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})}()}(),function(){"use strict";var e=angular.module("artisan");e.directive("calendarPopupRecords",["$templateCache","$parse","$q","$timeout","$filter","Hash","DateTime","Range","CalendarFactory","State","Api",function(e,t,f,h,n,r,d,g,m,p,y){return{restrict:"A",template:function(e,t){return'<div calendar-popup="options"></div>'},require:"ngModel",scope:{user:"=calendarUser"},link:function(e,t,n,r,o){var s=e.user,i=new p,a={onMonthDidChange:function(e,t,n){var r=f.defer();(o=t,i=f.defer(),a=g.expand(o,7*d.DAY),f.all([y.gantt.absencesAndOvertimes(a.getParams()).then(function(e){u.absencesAndOvertimes=e}),y.gantt.calendar(a.getParams()).then(function(e){var t={};angular.forEach(e,function(e){t[e.key]=e}),u.unworkings=t,u.calendar=e}),y.gantt.records(s.id,a.getParams()).then(function(e){u.monthRecords=e.map(function(e){return e.state=new p,e.record.date=new Date(e.record.date),e})})]).then(function(e){i.resolve()},function(e){i.reject()}),i.promise).then(function(){!function(){var t=u.resource;if(!t)return;t.absencesAndOvertimes={},angular.forEach(u.absencesAndOvertimes,function(e){t.id===e.resourceId&&(t.absencesAndOvertimes[e.key]=e)})}(),function(e,t,n){var o=u.resource,r=u.monthRecords;if(!r)return;n.days.each(function(e){var t=0;e.working&&(t+=o.baseHours);var n=o.absencesAndOvertimes[e.key];n&&(t+=n.hours),e.availableHours=t;var r=(e.recordedHours=0)<t;e.working=!u.unworkings[e.key],e.holiday=!e.working&&!r&&!e.weekend,e.vacation=e.working&&!r,e.wasVacation=e.vacation&&e.past,e.wasWorkable=e.working&&e.past&&r,e.workable=e.working&&!e.past&&r}),angular.forEach(r,function(e){var t=n.days.get(e.record.key);t&&(t.recordedHours+=e.record.hours)}),n.days.each(function(e){e.green=e.working&&!l.isBefore(e.date)&&8<=e.recordedHours,e.orange=e.working&&!l.isBefore(e.date)&&e.recordedHours<8})}(0,0,n),r.resolve(function(e,t,n){var r=null;function o(){n.days.forward(),n.days.each(function(e){r||t.isOutside(e.date)||!e.working||e.vacation||(r=e.date)})}if(e){var i=m.getKey(e),a=n.days.get(i);a&&a.working&&!a.vacation?r=e:o()}else o();return r}(e,t,n))},function(){r.reject()});var o,i,a},onWeekDidSelect:function(e,t,n){return!0},onDayDidSelect:function(e,t,n){if(!e||l.isBefore(e.date))return;if(e&&e.working)return h(function(){r.$setViewValue(e.date)}),!0}},u={},c={state:i,options:a};angular.extend(e,c);var l=g.Day();i.busy(),f.all([y.gantt.resources.actives().then(function(e){var t;t=e,u.resources=t,angular.forEach(t,function(e){e.absencesAndOvertimes={},e.id===s.id&&(u.resource=e)})})]).then(function(e){i.ready()},function(e){i.error(e)})}}}]),e.directive("calendarPopup",["$templateCache","$parse","$q","$timeout","$filter","Hash","DateTime","Range","CalendarFactory","State","Api",function(r,e,t,n,o,i,a,d,g,s,u){return{priority:1002,restrict:"A",templateUrl:function(e,t){var n=t.template;n||(n="partials/calendar/popup",r.get(n)||r.put(n,'<div><json-formatter json="item"></json-formatter></div>'));return n},scope:{options:"=calendarPopup"},link:function(e,t,n,r,o){var i=new g,a=e.options||{onMonthDidChange:function(){},onWeekDidSelect:function(){},onDayDidSelect:function(){}},s=d.Month(),u=d.Week(),c=d.Day(),l={month:s,week:u,day:c},f={sources:l,doNavMonth:function(e){h(s.getDate(e))},onWeekSelect:function(e){if(!e)return;a.onWeekDidSelect(e,s,l.calendarMonth)},onDaySelect:function(e){if(!e)return;!0===a.onDayDidSelect(e,s,l.calendarMonth)&&(l.day.setDate(e.date),l.calendarMonth.days.each(function(e){e.selected=l.day.isCurrent(e.date)}))},getDayClasses:function(e){var t={day:e};e&&angular.extend(t,{today:e.$today,selected:e.selected,workable:e.workable,holiday:e.holiday,vacation:e.vacation,working:e.working,available:e.available,full:e.full,"status-green":e.green,"status-orange":e.orange});return t}};function h(e){var t,n;e&&!s.isOutside(e)||(e&&s.setDate(e),t=e,(n=i.getMonthByDate(s.getDate())).days.each(function(e){var t=e.date.getDay();e.dirty=!0,e.hours=0,e.availableHours=0,e.recordedHours=0,e.selected=l.day.isCurrent(e.date),e.past=e.key<d.today.key,e.weekend=0===t||6===t,e.working=!e.weekend,e.holiday=!1,e.vacation=!1,e.wasVacation=!1,e.wasWorkable=!1,e.workable=!1,e.green=!1,e.orange=!1}),l.calendarMonth=n,a.onMonthDidChange(t,s,n))}angular.extend(e,f),h()}}}])}(),function(){"use strict";var e=angular.module("artisan");e.service("Calendar",["DateTime","Hash",function(d,g){var m=this,r=new g("key"),o=new g("mKey"),e={getDate:t,clearMonth:function(e){e.days.each(function(e){e&&(e.hours=0,e.tasks=new g("id"))})},getMonthByDate:i,getWeekByDate:function(e){e=e||new Date;var t=Math.ceil(e.getTime()/d.DAY);return m.getMonthByDate(e).weeks.find(function(e){return e.days.find(function(e){return e.key===t})})},getMonths:function(e){r.removeAll(),o.removeAll();var t=0;for(;t<e;){var n=new Date;n.setFullYear(d.today.date.getFullYear()),n.setMonth(d.today.date.getMonth()+t),n.setDate(1),n.setHours(0),n.setMinutes(0),n.setSeconds(0);i(n);t++}return o},getMonth:function(e){return i(t(e))},getDay:function(e){var t=new Date(d.today.date);return t.setDate(t.getDate()+e),t},getKey:function(e){return Math.ceil(e.getTime()/d.DAY)},days:r,months:o};function t(e){return"function"==typeof e.date.getMonth?e.date:new Date(e.date)}function i(e){var u=(e=e||new Date).getFullYear(),c=e.getMonth(),t=(Math.ceil(e.getTime()/d.DAY),12*u+c),l=o.get(t);if(!l){var f=new Date(u,c,1).getDay()-1;f=f<0?6:f;var h=new Date(u,c+1,0).getDate();(l={date:e,mKey:t,month:c,monthDays:h,fromDay:f,days:new g("key")}).weeks=new Array(6).fill().map(function(e,a){var s=new g("key");return new Array(7).fill().map(function(e,t){var n=null,r=7*a+t-f;if(0<=r&&r<h){var o=new Date(u,c,r+1),i=Math.ceil(o.getTime()/d.DAY);n={$today:i===d.today.key,c:t,r:a,d:r+1,date:o,key:i,hours:0,tasks:new g("id")},m.days.add(n),n=l.days.add(n),s.add(n)}return n}),{r:a,date:new Date(u,c,7*a-f+1),days:s}}),l.getMonth=function(e){return e=e||0,new Date(u,c+e,1)},l=o.add(l)}return l}angular.extend(m,e)}]),e.factory("CalendarFactory",["$filter","DateTime","Hash",function(g,m,p){function e(){this.days=new p("key"),this.weeks=new p("wKey"),this.months=new p("mKey")}var t={clearMonth:function(e){e.days.each(function(e){e&&(e.hours=0,e.tasks=new p("id"))})},getDate:r,getDay:function(e){var t=new Date(m.today.date);return t.setDate(t.getDate()+e),t},getKey:function(e){return Math.ceil(e.getTime()/m.DAY)}},n={getWeeks:function(e){var t=this;t.days.removeAll(),t.weeks.removeAll(),t.months.removeAll();var n=0;for(;n<e;){var r=new Date;r.setFullYear(m.today.date.getFullYear()),r.setMonth(m.today.date.getMonth()+n),r.setDate(1),r.setHours(0),r.setMinutes(0),r.setSeconds(0);t.getWeekByDate(r);n++}return t.weeks},getWeek:function(e){var t=r(e);return this.getWeekByDate(t)},getWeekByDate:function(e){e=e||new Date;var i=this,t=e.getFullYear(),n=e.getMonth(),r=e.getDay(),o=e.getDate()-r+(0===r?-6:1),a=new Date(e.setDate(o)),s=g("isoWeek")(e,1),u=Math.ceil(a.getTime()/m.DAY),c=60*t+s,l=12*t+n,f=i.weeks.get(c);if(!f){var h=new p("key");new Array(7).fill().map(function(e,t){var n=new Date(a);n.setDate(a.getDate()+t);var r=Math.ceil(n.getTime()/m.DAY),o={$today:r===m.today.key,c:t,d:n.getDate(),date:n,key:r};return i.days.add(o),h.add(o),o}),f={isoWeek:s,key:u,wKey:c,mKey:l,date:a,days:h},f=i.weeks.add(f)}return f},getMonths:function(e){this.days.removeAll(),this.months.removeAll();var t=0;for(;t<e;){var n=new Date;n.setFullYear(m.today.date.getFullYear()),n.setMonth(m.today.date.getMonth()+t),n.setDate(1),n.setHours(0),n.setMinutes(0),n.setSeconds(0);this.getMonthByDate(n);t++}return this.months},getMonth:function(e){var t=r(e);return this.getMonthByDate(t)},getMonthByDate:function(e){e=e||new Date;var u=this,c=e.getFullYear(),l=e.getMonth(),t=(Math.ceil(e.getTime()/m.DAY),12*c+l),f=u.months.get(t);if(!f){var h=new Date(c,l,1).getDay()-1;h=h<0?6:h;var d=new Date(c,l+1,0).getDate();(f={date:e,mKey:t,month:l,monthDays:d,fromDay:h,days:new p("key")}).weeks=new Array(6).fill().map(function(e,a){var s=new p("key");new Array(7).fill().map(function(e,t){var n=null,r=7*a+t-h;if(0<=r&&r<d){var o=new Date(c,l,r+1),i=Math.ceil(o.getTime()/m.DAY);n={$today:i===m.today.key,c:t,r:a,d:r+1,date:o,key:i,hours:0,tasks:new p("id")},u.days.add(n),n=f.days.add(n),s.add(n)}return n});var t=new Date(c,l,7*a-h+1),n=g("isoWeek")(t,1),r=60*c+n;return{r:a,wKey:r,date:t,days:s}}),f.getMonth=function(e){return e=e||0,new Date(c,l+e,1)},f=u.months.add(f)}return f}};return angular.extend(e,t),angular.extend(e.prototype,n),e;function r(e){return"function"==typeof e.date.getMonth?e.date:new Date(e.date)}}])}(),function(){"use strict";var e=angular.module("artisan");e.service("DateTime",[function(){var r=6e4,t=15*r,n=60*r,o=24*n,e=7*o,i=1,a=g(),s={getIndexLeft:E,getIndexRight:D,getDayLeft:function(e,t,n,r){r=r||1;var o=c(e),i=Math.floor(o.dd/r)*r;return i+=E(t,n,r),f(e=new Date(o.yyyy,o.MM,i,o.HH,o.mm,o.ss,o.sss))},getDayRight:function(e,t,n,r){r=r||1;var o=c(e),i=Math.floor(o.dd/r)*r;return i+=D(t,n,r),h(e=new Date(o.yyyy,o.MM,i,o.HH,o.mm,o.ss,o.sss))},getMonthLeft:function(e,t,n,r){r=r||1;var o=c(e),i=Math.floor(o.MM/r)*r;return i+=E(t,n,r),w(e=new Date(o.yyyy,i,o.dd,o.HH,o.mm,o.ss,o.sss))},getMonthRight:function(e,t,n,r){r=r||1;var o=c(e),i=Math.floor(o.MM/r)*r;return i+=D(t,n,r),x(e=new Date(o.yyyy,i,o.dd,o.HH,o.mm,o.ss,o.sss))},getWeekLeft:function(e,t,n,r){var o=c(e),i=o.dd+7*E(t,n,r);return b(e=new Date(o.yyyy,o.MM,i,o.HH,o.mm,o.ss,o.sss))},getWeekRight:function(e,t,n,r){var o=c(e),i=o.dd+7*D(t,n,r);return k(e=new Date(o.yyyy,o.MM,i,o.HH,o.mm,o.ss,o.sss))},getYearLeft:T,getYearRight:function(e,t,n,r){r=r||1;var o=c(e),i=Math.floor(o.yyyy/r)*r;return i+=D(t,n,r),$(e=new Date(i,o.MM,o.dd,o.HH,o.mm,o.ss,o.sss))},dateToKey:l,dayDiff:function(e,t){var n=c(t);return new Date(n.yyyy,n.MM,n.dd+e,n.HH,n.mm,n.ss,n.sss)},dayLeft:f,dayRight:h,getDate:d,getFullDate:g,getDay:m,getFullDay:y,getWeek:R,getDayByKey:function(e){return m(v(e),e)},getDayByDate:p,hourToTime:function(e){return e*n},keyToDate:v,monthDiff:function(e,t,n){n=n||1;var r=c(t),o=Math.floor(r.MM/n)*n+e*n;return new Date(r.yyyy,o,1,r.HH,r.mm,r.ss,r.sss)},monthLeft:w,monthRight:x,today:a,weekDiff:function(e,t){var n=c(t);return new Date(n.yyyy,n.MM,n.dd+7*e,n.HH,n.mm,n.ss,n.sss)},weekLeft:b,weekRight:k,yearDiff:function(e,t){var n=c(t);return new Date(n.yyyy,n.MM+12*e,n.dd,n.HH,n.mm,n.ss,n.sss)},yearLeft:M,yearRight:$,timeToHour:function(e){return e/n},timeToQuarterHour:function(e){return Math.floor(e/t)*t/n},SECOND:1e3,MINUTE:r,QUARTER:t,HOUR:n,DAY:o,WEEK:e,FIRSTDAYOFWEEK:i};function u(e){return e=e?new Date(e):new Date}function c(e){return{date:e=u(e),yyyy:e.getFullYear(),MM:e.getMonth(),dd:e.getDate(),ee:e.getDay(),HH:e.getHours(),mm:e.getMinutes(),ss:e.getSeconds(),sss:e.getMilliseconds()}}function l(e){var t=(e=f(u(e))).getTimezoneOffset();return Math.floor((e.valueOf()-t*r)/o)}function f(e){var t=c(e);return new Date(t.yyyy,t.MM,t.dd,0,0,0,0)}function h(e){var t=c(e);return new Date(t.yyyy,t.MM,t.dd,23,59,59,999)}function d(e){return p(e=f(e))}function g(e){return y(d(e))}function m(e,t){return{date:e,key:t}}function p(e){return m(e,l(e))}function y(e){var t=c(e.date);return t.key=e.key,t.wKey=l(b(e.date)),t.mKey=l(w(e.date)),t.ww=R(e.date,i),t}function v(e){var t=new Date,n=t.getTimezoneOffset();return new Date(t.setTime(e*o+n*r))}function w(e,t){t=t||1;var n=c(e),r=Math.floor(n.MM/t)*t;return new Date(n.yyyy,r,1,0,0,0,0)}function x(e,t){t=t||1;var n=c(e),r=Math.floor(n.MM/t)*t;return new Date(n.yyyy,r+t,0,23,59,59,999)}function b(e){var t=c(e);return new Date(t.yyyy,t.MM,t.dd-t.ee+i,0,0,0,0)}function k(e){var t=c(e);return new Date(t.yyyy,t.MM,t.dd-t.ee+i+6,23,59,59,999)}function M(e){var t=c(e);return new Date(t.yyyy,0,1,0,0,0,0)}function $(e){var t=c(e);return new Date(t.yyyy,12,0,23,59,59,999)}function E(e,t,n){return t=t||1,(e=e||0)*(n=n||1)}function D(e,t,n){var r=E(e,t=t||1,n=n||1);return r+=t*n-1}function T(e,t,n,r){r=r||1;var o=c(e),i=Math.floor(o.yyyy/r)*r;return i+=E(t,n,r),M(e=new Date(i,o.MM,o.dd,o.HH,o.mm,o.ss,o.sss))}function S(e,t){t=t||0;var n=e.getDay();return(n-=t)<0&&(n+=7),n}function R(e,t){var n=p(e),r=p(T(e)),o=S(r.date,t),i=n.key-r.key,a=Math.floor((i+o)/7);return o<4&&52<++a&&(a=(o=S(T(e,1),t))<4?1:53),a}angular.extend(this,s)}]),e.filter("isoWeek",["DateTime",function(r){return function(e,t){if(e){var n=r.getWeek(e,t);return n<10?"0"+n:n}return"-"}}])}(),function(){"use strict";var e=angular.module("artisan"),c={long:{RANGE:"{from|date:MMM yyyy} - {to|date:MMM yyyy}",YEAR:"Anno {from|date:yyyy}",SEMESTER:"Semestre {from|date:MMM yyyy} - {to|date:MMM yyyy}",TRIMESTER:"Quadrimestre {from|date:MMM yyyy} - {to|date:MMM yyyy}",QUARTER:"Trimestre {from|date:MMM yyyy} - {to|date:MMM yyyy}",MONTH:"{from|date:MMMM yyyy}",WEEK:"Settimana {to|isoWeek:1}",DAY:"{from|date:EEEE dd MMM yyyy}"},short:{RANGE:"{from|date:MMM yyyy} - {to|date:MMM yyyy}",YEAR:"{from|date:yyyy}",SEMESTER:"{from|date:MMM yyyy} - {to|date:MMM yyyy}",TRIMESTER:"{from|date:MMM yyyy} - {to|date:MMM yyyy}",QUARTER:"{from|date:MMM yyyy} - {to|date:MMM yyyy}",MONTH:"{from|date:MMMM}",WEEK:"W{to|isoWeek:1}",DAY:"{from|date:EEEE}"},week:1};e.constant("RangeTypes",{RANGE:10,YEAR:11,SEMESTER:12,TRIMESTER:13,QUARTER:14,MONTH:15,WEEK:16,DAY:17}),e.factory("Range",["$filter","DateTime","RangeTypes",function(s,o,r){function n(e){this.from=o.dayLeft(),this.type=r.QUARTER,e&&angular.extend(this,e),this.setDiff()}var e={setYear:function(e,t,n,r){return this.from=o.getYearLeft(e,t,n,r),this.to=o.getYearRight(e,t,n,r),this},setSemester:function(e,t,n){return this.setMonth(e,t,n,6)},setTrimester:function(e,t,n){return this.setMonth(e,t,n,4)},setQuarter:function(e,t,n){return this.setMonth(e,t,n,3)},setMonth:function(e,t,n,r){return this.from=o.getMonthLeft(e,t,n,r),this.to=o.getMonthRight(e,t,n,r),this},setWeek:function(e,t,n,r){return this.from=o.getWeekLeft(e,t,n,r),this.to=o.getWeekRight(e,t,n,r),this},setDay:function(e,t,n,r){return this.from=o.getDayLeft(e,t,n,r),this.to=o.getDayRight(e,t,n,r),this},setKey:function(e,t,n,r){return this.setDay(o.keyToDate(e),t,n,r)},prev:function(){return this.setDiff(-1)},next:function(){return this.setDiff(1)},getDiff:function(e){return new n({type:this.type}).setDate(this.from).setDiff(e)},getParams:function(){return{dateFrom:new Date(this.from),dateTo:new Date(this.to)}},getDate:function(e){e=e||0;var t=new Date(this.from);switch(this.type){case r.YEAR:t=new Date(t.setFullYear(t.getFullYear()+e));break;case r.SEMESTER:t=new Date(t.setMonth(t.getMonth()+6*e));break;case r.TRIMESTER:t=new Date(t.setMonth(t.getMonth()+4*e));break;case r.QUARTER:t=new Date(t.setMonth(t.getMonth()+3*e));break;case r.MONTH:t=new Date(t.setMonth(t.getMonth()+e));break;case r.WEEK:t=new Date(t.setDate(t.getDate()+7*e));break;case r.DAY:t=new Date(t.setDate(t.getDate()+e))}return t},setDate:function(e,t){var n=this;switch(n.type){case r.YEAR:n.setYear(e,t);break;case r.SEMESTER:n.setSemester(e,t);break;case r.TRIMESTER:n.setTrimester(e,t);break;case r.QUARTER:n.setQuarter(e,t);break;case r.MONTH:n.setMonth(e,t);break;case r.WEEK:n.setWeek(e,t);break;case r.DAY:n.setDay(e,t)}return n},setDiff:function(e){var t=this;switch(t.type){case r.YEAR:t.setYear(t.from,e);break;case r.SEMESTER:t.setSemester(t.from,e);break;case r.TRIMESTER:t.setTrimester(t.from,e);break;case r.QUARTER:t.setQuarter(t.from,e);break;case r.MONTH:t.setMonth(t.from,e);break;case r.WEEK:t.setWeek(t.from,e);break;case r.DAY:t.setDay(t.from,e)}return t},set:function(e,t){e.dateFrom=this.from,e.dateTo=this.to,t&&t.setDates(e.dateFrom,e.dateTo);return this},is:function(e){var t=!1;e.dateFrom&&e.dateTo&&(t=e.dateFrom.getTime()==this.from.getTime()&&e.dateTo.getTime()==this.to.getTime());return t},isInside:function(e){return!this.isOutside(e)},isOutside:function(e){e=e||new Date;return e<this.from||e>this.to},isCurrent:function(e){return e=e||new Date,!this.isOutside(e)},isBefore:function(e){return e=e||new Date,this.to<e},isAfter:function(e){return e=e||new Date,this.from>e},equals:function(e){return e&&o.dateToKey(e.from)===o.dateToKey(this.from)&&o.dateToKey(e.to)===o.dateToKey(this.to)},eachDay:function(e){if("function"!=typeof e)return this;var t=o.dateToKey(this.from),n=o.dateToKey(this.to);for(;t<=n;)e(o.getDayByKey(t,c.week)),t++;return this},totalDays:function(){var e=o.dateToKey(this.from);return o.dateToKey(this.to)-e+1},getName:function(){var e=u(r,this.type);return a(this,c.long[e])},getShortName:function(){var e=u(r,this.type);return a(this,c.short[e])},toString:function(){return"["+s("date")(this.from,"MMM dd yyyy HH:mm:ss.sss")+", "+s("date")(this.to,"MMM dd yyyy HH:mm:ss.sss")+"] '"+this.getName()+"'"}},t={copy:i,expand:function(e,t){return(e=i(e)).from=new Date(e.from.getTime()-t),e.to=new Date(e.to.getTime()+t),e},getMonth:function(e){return e?((e=new Date(e)).setDate(1),e.setHours(0,0,0,0),e.getTime()):null},addYear:function(e,t){return e?(e=new Date(e),new Date(e.setFullYear(e.getFullYear()+t))):null},types:r,Year:function(){return new n({type:r.YEAR})},Semester:function(){return new n({type:r.SEMESTER})},Trimester:function(){return new n({type:r.TRIMESTER})},Quarter:function(){return new n({type:r.QUARTER})},Month:function(){return new n({type:r.MONTH})},Week:function(){return new n({type:r.WEEK})},Day:function(){return new n({type:r.DAY})},getDate:o.getDate,getFullDate:o.getFullDate,dateToKey:o.dateToKey,keyToDate:o.keyToDate,getDay:o.getDay,getFullDay:o.getFullDay,getDayByKey:o.getDayByKey,getDayByDate:o.getDayByDate,today:o.today,DateTime:o};return angular.extend(n.prototype,e),angular.extend(n,t),n;function i(e){var t=new n(e);return t.from=new Date(e.from),t.to=new Date(e.to),t}function a(a,e){var t=e;return t=t.replace(/{(.*?)}/g,function(e,t){var n,r=t.split("|"),o=r.shift(),i=r.join("");return-1!==i.indexOf(":")&&(n=(i=i.split(":")).length?i.pop():null,i=i.join("")),i.length?s(i)(a[o],n):a[o]})}function u(e,t){return Object.keys(e)[Object.values(e).indexOf(t)]}}]),"function"!=typeof Object.values&&Object.defineProperty(Object,"values",{value:function(e){var t=[];for(var n in e)has(e,n)&&isEnumerable(e,n)&&t.push(e[n]);return t}})}(),function(){"use strict";var e=angular.module("artisan");e.value("$formats",{just_now:"just now",seconds_ago:"{{num}} seconds ago",a_minute_ago:"a minute ago",minutes_ago:"{{num}} minutes ago",an_hour_ago:"an hour ago",hours_ago:"{{num}} hours ago",a_day_ago:"yesterday",days_ago:"{{num}} days ago",a_week_ago:"a week ago",weeks_ago:"{{num}} weeks ago",a_month_ago:"a month ago",months_ago:"{{num}} months ago",a_year_ago:"a year ago",years_ago:"{{num}} years ago",over_a_year_ago:"over a year ago",seconds_from_now:"{{num}} seconds from now",a_minute_from_now:"a minute from now",minutes_from_now:"{{num}} minutes from now",an_hour_from_now:"an hour from now",hours_from_now:"{{num}} hours from now",a_day_from_now:"tomorrow",days_from_now:"{{num}} days from now",a_week_from_now:"a week from now",weeks_from_now:"{{num}} weeks from now",a_month_from_now:"a month from now",months_from_now:"{{num}} months from now",a_year_from_now:"a year from now",years_from_now:"{{num}} years from now",over_a_year_from_now:"over a year from now"}),e.filter("dateRelative",["$rootScope","$interval","$injector","$formats",function(e,t,n,r){var i=86400,a=7*i,s=30*i,u=n.has("$format")?n.get("$format"):{instant:function(e,t){return r[e].replace("{{num}}",t.num)}};function c(e,t){return Math.round(Math.abs(e-t)/1e3)}return function(e){e instanceof Date||(e=new Date(e));var t=new Date,n=c(t,e);i<n&&n<a&&(e=new Date(e.getFullYear(),e.getMonth(),e.getDate(),0,0,0,0),n=c(t,e));var r=e<=t?"_ago":"_from_now";function o(e,t){return u.instant(e+(30<n?r:""),{num:t})}return console.log("delta",n,t,e),n<30?o("just_now"):n<60?o("seconds",n):n<120?o("a_minute"):n<3600?o("minutes",Math.floor(n/60)):n<7200?o("an_hour"):n<i?o("hours",Math.floor(n/3600)):n<2*i?o("a_day"):n<a?o("days",Math.floor(n/i)):1!==Math.floor(n/a)?o("a_week"):n<s?o("weeks",Math.floor(n/a)):1!==Math.floor(n/s)?o("a_month"):n<31536e3?o("months",Math.floor(n/s)):1!==Math.floor(n/31536e3)?o("a_year"):o("over_a_year")}}]),e.directive("dateRelative",["$parse","$filter","$interval",function(a,s,e){return{priority:1001,restrict:"A",link:function(n,r,o,e){function t(){var e=a(o.dateRelative)(n),t=s("dateRelative")(e);r[0].innerHTML=t}t();var i=setInterval(t,6e4);n.$on("$destroy",function(){cancelInterval(i)})}}}])}(),function(){"use strict";angular.module("artisan").service("Dom",["Point","Rect",function(a,n){var e,t,r,o,i,s,u,c={getBoundRect:function(e){(e=h(e))===window&&(e=l());return e.getBoundingClientRect()},getClosest:function(e,t){var n,r;if(["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"].some(function(e){return"function"==typeof document.body[e]&&(n=e,!0)}),e[n](t))return e;for(;null!==e;){if(null!==(r=e.parentElement)&&r[n](t))return r;e=r}return null},getClosestNode:function(e,t){var n=null;if(e===t)return e;for(;null!==e;){if(null!==(n=e.parentElement)&&n===t)return n;e=n}return null},getDelta:function(e){var t=e.originalEvent?e.originalEvent:e,n=t.type,r=null;if("wheel"===n||"mousewheel"===n||"DOMMouseScroll"===n){var o=t.deltaX||t.wheelDeltaX,i=t.deltaY||t.wheelDeltaY;r=new a(o,i),Math.abs(o)>Math.abs(i)?r.dir=o<0?1:-1:r.dir=i<0?1:-1}return r},getDocumentNode:l,getElement:f,getNode:h,getNodeOffset:function(e){var t=new a;(e=h(e))&&1===e.nodeType&&(t.x=e.offsetLeft,t.y=e.offsetTop);return t},getPageScroll:function(){var e=new a,t=l();return e.x=window.pageXOffset||t.scrollLeft,e.y=window.pageYOffset||t.scrollTop,e},getParents:function(e,t){t=t||l();var n=[];if(e){n.push(e);for(var r=e.parentNode;r&&r!==t;)n.push(r),r=r.parentNode;n.push(t)}return n.each=function(t){this.filter(function(e){t&&t(angular.element(e),e)})},n},getView:function(){var e=new n;if(void 0!==window.innerWidth)e.width=window.innerWidth,e.height=window.innerHeight;else{var t=l();e.width=t.clientWidth,e.height=t.clientHeight}return e},getPointInView:function(e){var t=e.originalEvent?e.originalEvent:e,n=t.type,r=null;if(-1!==g.indexOf(n)){var o=null,i=t.touches.length?t.touches:t.changedTouches;i&&i.length&&(o=i[0]),o&&((r=new a).x=o.pageX,r.y=o.pageY)}else-1!==d.indexOf(n)&&((r=new a).x=t.pageX,r.y=t.pageY);return r},compileController:function(e,t,n,r){(t=f(t)).html(n);var o=$compile(t.contents());if(r.controller){var i=e.$new();angular.extend(i,r);var a=$controller(r.controller,{$scope:i});r.controllerAs&&(e[r.controllerAs]=a),t.data("$ngControllerController",a),t.children().data("$ngControllerController",a),e=i}o(e)},downloadFile:function(e,r,t){t=t||"application/octet-stream";var o=null,n=new Blob([e],{type:t}),i=new window.FileReader;i.readAsDataURL(n),i.onloadend=function(){o=i.result,function(){if(document.createEvent){var e=document.createElement("a");if(e.href=o,void 0!==e.download){var t=r||o.substring(o.lastIndexOf("/")+1,o.length);e.download=t}var n=document.createEvent("MouseEvents");return n.initEvent("click",!0,!0),e.dispatchEvent(n)}window.open(-1<o.indexOf("?")?o:o+"?download","_self")}()}},ua:(e=window.navigator.userAgent.toLowerCase(),t=-1!==e.indexOf("safari")&&-1===e.indexOf("chrome"),r=-1!==e.indexOf("trident")||-1!==e.indexOf("edge")||-1!==e.indexOf("msie"),o=!t&&!r&&-1!==e.indexOf("chrome"),i=-1!==e.indexOf("mobile"),s=-1!==e.indexOf("macintosh"),u={agent:e,safari:t,msie:r,chrome:o,mobile:i,mac:s},angular.forEach(u,function(e,t){e&&angular.element(document.getElementsByTagName("body")).addClass(t)}),u)};function l(){return document.documentElement||document.body.parentNode||document.body}function f(e){return angular.isArray(e)?e:angular.element(e)}function h(e){return angular.isArray(e)?e[0]:e}angular.extend(this,c);var d=["click","mousedown","mouseup","mousemove","mouseover","mouseout","mouseenter","mouseleave","contextmenu"],g=["touchstart","touchmove","touchend","touchcancel"]}])}(),function(){"use strict";var e=angular.module("artisan");e.factory("Event",["EventsService","Dom","Point","Rect",function(e,d,g,t){function n(e,t){try{var n=(e=e||window.event).type,r=e.originalEvent?e.originalEvent:e,o=t[0],i=d.getNodeOffset(o),a=d.getBoundRect(o),s=d.getView(),u=d.getPageScroll(),c=d.getPointInView(e);if(c){var l=new g(c.x-u.x,c.y-u.y),f=new g(l.x-a.left,l.y-a.top);this.point=c,this.absolute=l,this.relative=f}var h=d.getDelta(e);h&&(this.delta=h,this.dir=h.dir),this.event=e,this.type=n,this.originalEvent=r,this.element=t,this.node=o,this.offset=i,this.rect=a,this.view=s,this.scroll=u,this.timestamp=(new Date).getTime()}catch(e){console.log("Event.error",e)}}var r={stop:function(){this.event.stopPropagation(),this.event.preventDefault()}};return angular.extend(n,{}),angular.extend(n.prototype,r),n}]),e.factory("Events",["EventsService","Event","Dom",function(e,r,o){function n(e){var n=this;this.element=o.getElement(e),this.listeners={},this.standardEvents={click:{key:"click",callback:function(e){var t=new r(e,n.element);n.setTimestamp(t),n.listeners.click.apply(this,[t])}},down:{key:"mousedown",callback:function(e){var t=new r(e,n.element);n.setTimestamp(t),n.listeners.down.apply(this,[t]),n.removeTouchEvents()}},move:{key:"mousemove",callback:function(e){var t=new r(e,n.element);n.setTimestamp(t),n.listeners.move.apply(this,[t])}},up:{key:"mouseup",callback:function(e){var t=new r(e,n.element);n.setTimestamp(t),n.listeners.up.apply(this,[t])}},resize:{key:"resize",callback:function(e){var t=new r(e,n.element);n.setTimestamp(t),n.listeners.resize.apply(this,[t])}}},this.touchEvents={down:{key:"touchstart",callback:function(e){var t=new r(e,n.element);n.setTimestamp(t),n.listeners.down.apply(this,[t]),n.removeStandardEvents()}},move:{key:"touchmove",callback:function(e){var t=new r(e,n.element);n.setTimestamp(t),n.listeners.move.apply(this,[t])}},up:{key:"touchend",callback:function(e){var t=new r(e,n.element);n.setTimestamp(t),n.listeners.up.apply(this,[t])}}},this.wheelEvents={wheel:{key:"mousewheel",callback:function(e){var t=new r(e,n.element);n.setTimestamp(t),n.listeners.wheel.apply(this,[t]),n.removeScrollEvents()}}},this.scrollEvents={wheel:{key:"DOMMouseScroll",callback:function(e){var t=new r(e,n.element);n.setTimestamp(t),n.listeners.wheel.apply(this,[t]),n.removeWheelEvents()}}},this.timestamp=(new Date).getTime(),this.setTimestamp=function(e){e&&(e.interval=Math.min(250,e.timestamp-n.timestamp));n.timestamp=(new Date).getTime()}}var i={getTouch:function(e,n){var r=new Point;if("touchstart"===e.type||"touchmove"===e.type||"touchend"===e.type||"touchcancel"===e.type){var o=null,i=e.originalEvent?e.originalEvent:e,a=i.touches.length?i.touches:i.changedTouches;a&&a.length&&(o=a[0]),o&&(r.x=o.pageX,r.y=o.pageY)}else"click"!==e.type&&"mousedown"!==e.type&&"mouseup"!==e.type&&"mousemove"!==e.type&&"mouseover"!==e.type&&"mouseout"!==e.type&&"mouseenter"!==e.type&&"mouseleave"!==e.type&&"contextmenu"!==e.type||(r.x=e.pageX,r.y=e.pageY);n&&(r.s=Point.difference(t,n));return r.type=e.type,r},getRelativeTouch:function(e,t){return e=angular.isArray(e)?e[0]:e,Point.difference(t,{x:e.offsetLeft,y:e.offsetTop})}},a={add:function(e,t){var r=this,o=this.standardEvents,i=this.touchEvents,a=this.wheelEvents,s=this.scrollEvents,u=this.element,c=angular.element(window);angular.forEach(e,function(e,t){if(r.listeners[t]){var n={};n[t]=r.listeners[t],l(n)}r.listeners[t]=e,o[t]&&("resize"===t?c.on(o[t].key,o[t].callback):u.on(o[t].key,o[t].callback)),i[t]&&u.on(i[t].key,i[t].callback),a[t]&&u.on(a[t].key,a[t].callback),s[t]&&u.on(s[t].key,s[t].callback)}),t&&t.$on("$destroy",function(){r.remove(e)});return r},remove:l,removeStandardEvents:function(){var e=this.standardEvents,t=(this.touchEvents,this.element);t.off("mousedown",e.down.callback),t.off("mousemove",e.move.callback),t.off("mouseup",e.up.callback)},removeTouchEvents:function(){this.standardEvents;var e=this.touchEvents,t=this.element;t.off("touchstart",e.down.callback),t.off("touchmove",e.move.callback),t.off("touchend",e.up.callback)},removeWheelEvents:function(){this.element.off("mousewheel",this.mouseEvents.wheel.callback)},removeScrollEvents:function(){this.element.off("DOMMouseScroll",this.scrollEvents.wheel.callback)}};return angular.extend(n,i),angular.extend(n.prototype,a),n;function l(e){var n=this,r=this.standardEvents,o=this.touchEvents,i=this.wheelEvents,a=this.scrollEvents,s=this.element,u=angular.element(window);return angular.forEach(e,function(e,t){r[t]&&("resize"===t?u.off(r[t].key,r[t].callback):s.off(r[t].key,r[t].callback)),o[t]&&s.off(o[t].key,o[t].callback),i[t]&&s.off(i[t].key,i[t].callback),a[t]&&s.off(a[t].key,a[t].callback),n.listeners[t]=null}),n}}]),e.service("EventsService",["Dom",function(t){var e={hasPassiveEvents:n,addEventListener:function(){if(!n())return;var i={passive:!1,capture:!1};var e=function(o){function e(e,t,n){if("object"!=typeof n){var r=!0===n;(n=angular.copy(i)).capture=r}else n=angular.extend(angular.copy(i),n);o.call(this,e,t,n)}return e}(EventTarget.prototype.addEventListener);return EventTarget.prototype.addEventListener=e}()};function n(){var e=!1;if(window.addEventListener)try{var t=Object.defineProperty({},"passive",{get:function(){e=!0}});window.addEventListener("test",null,t)}catch(e){console.log("getAddEventListener.isSupprted",e)}return e}angular.extend(this,e),function(){if(!t.ua.mac)return;(t.ua.chrome||t.ua.safari||t.ua.firefox)&&window.addEventListener("mousewheel",function(e){if(Math.abs(e.deltaY)>Math.abs(e.deltaX))return;(e.deltaX<0&&0===t.getParents(e.target).filter(function(e){return 0<e.scrollLeft}).length||0<e.deltaX&&0===t.getParents(e.target).filter(function(e){return e.scrollWidth-e.scrollLeft>e.clientWidth}).length)&&e.preventDefault()},{passive:!1})}()}])}(),function(){"use strict";var e=angular.module("artisan");e.filter("notIn",["$filter",function(t){return function(e,n,r){if(n)return t("filter")(e,function(e){for(var t=0;t<n.length;t++)if(n[t][r]===e[r])return!1;return!0})}}]),e.filter("autolink",[function(){return function(e){return Autolinker.link(e,{className:"a-link"})}}]),e.filter("shortName",["$filter",function(e){return function(e){if(!e)return"";e.indexOf(" .")===e.length-2&&(e=e.split(" .").join(""));var t=e.split(" "),n=t.shift();if(t.length){var r=t.join(" ");return n.substr(0,1).toUpperCase()+"."+r.replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()})}return n}}]),e.filter("customCurrency",["$filter",function(e){var n=e("currency");return function(e,t){return n(e*t.ratio,t.formatting)}}]),e.filter("customSize",["APP",function(o){return function(e){if(o.unit===o.units.IMPERIAL){var t=Math.floor(e/12);return e%=12,(t?t+"' ":"")+(e=Math.round(10*e)/10)+"''"}var n=Math.floor(e*o.size.ratio),r=e*o.size.ratio*100%100;return(n?n+"m ":"")+(r=Math.round(10*r)/10)+"cm"}}]),e.filter("customWeight",["APP",function(o){return function(e){if(o.unit===o.units.IMPERIAL){if(e<1){var t=16*e;return(t=Math.round(10*t)/10)?t+"oz ":""}return(e=Math.round(100*e)/100)?e+"lb ":""}var n=Math.floor(e*o.weight.ratio/1e3),r=e*o.weight.ratio%1e3;return(n?n+"kg ":"")+(r=Math.round(10*r)/10)+"g"}}]),e.filter("customNumber",["$filter",function(r){return function(e,t,n){return n=n||"",e=void 0!==e?(Math.floor(e)===e&&(t=0),r("number")(e,t)+n):"-"}}]),e.filter("reportNumber",["$filter",function(r){return function(e,t,n){return n=n||"",e=void 0!==e?r("number")(e,t)+n:"-"}}]),e.filter("customHours",[function(){return function(e){if(void 0===e)return"-";var t=Math.floor(e),n=Math.floor(60*(e-t)),r=t?t+" H":"";return r+=n?" "+n+" m":""}}]),e.filter("customTimer",[function(){return function(e){if(void 0===e)return"-";var t=Math.floor(e/36e5),n=Math.floor((e-36e5*t)/6e4),r=Math.floor((e-36e5*t-6e4*n)/1e3),o=t?t+" H":"";return o+=n?" "+n+" m":"",o+=r?" "+r+" s":""}}]),e.filter("customDigitalTimer",[function(){return function(e){if(void 0===e)return"-";var t=Math.floor(e/36e5),n=Math.floor((e-36e5*t)/6e4),r=Math.floor((e-36e5*t-6e4*n)/1e3);return(t<10?"0":"")+t+":"+(n<10?"0":"")+n+":"+(r<10?"0":"")+r}}]),e.filter("customDigitalTime",[function(){return function(e){if(void 0===e)return"-";var t=Math.floor(e/36e5),n=Math.floor((e-36e5*t)/6e4);return(t<10?"0":"")+t+":"+(n<10?"0":"")+n}}]),e.filter("customDate",["$filter",function(e){var r=e("date");return function(e,t,n){return e?r(e,t,n):"-"}}]),e.filter("customTime",["$filter",function(e){return function(e,t){return e?Utils.parseTime(e):t||"-"}}]),e.filter("customDigital",["$filter",function(e){return function(e,t){return e?Utils.parseHour(e):t||"-"}}]),e.filter("customString",["$filter",function(e){return function(e,t){return e||(t||"-")}}]),e.filter("customEnum",function(){return function(e){return(e+=1)<10?"0"+e:e}}),e.filter("groupBy",["$parse","filterWatcher",function(a,s){return function(e,t){return!angular.isObject(e)||angular.isUndefined(t)?e:s.isMemoized("groupBy",arguments)||s.memoize("groupBy",arguments,this,(n=e,r=a(t),i={},angular.forEach(n,function(e){o=r(e),i[o]||(i[o]=[]),i[o].push(e)}),i));var n,r,o,i}}]),e.filter("htmlToPlaintext",function(){function s(e){var t,n,r="";if(e.nodeType==document.TEXT_NODE)r=(r=(r=e.nodeValue)?String(r).replace(/</gm,"&lt;"):"")?String(r).replace(/>/gm,"&gt;"):"";else if(e.nodeType==document.ELEMENT_NODE){for(var o=0,i=e.childNodes.length;o<i;o++)r+=s(e.childNodes[o]);var a=(n="display",(t=e).currentStyle?t.currentStyle[n]:window.getComputedStyle(t,null).getPropertyValue(n));(a.match(/^block/)||a.match(/list/)||a.match(/row/)||"BR"==e.tagName||"HR"==e.tagName)&&(r+="\n<br>")}return r}return function(e){console.log(e);var t=document.createElement("div");return t.innerHTML=e,s(t)}})}(),function(){"use strict";angular.module("artisan").factory("Point",[function(){function n(e,t){this.x=e||0,this.y=t||0}var e={difference:r,multiply:o},t={clone:function(){return new n(this.x,this.y)},copy:function(e){return this.x=e.x,this.y=e.y,this},difference:function(e){return r(this,e)},mult:function(e){return o(this,e)},offset:function(e,t){return this.x+=e,this.y+=t,this},setPos:function(e,t){return this.x=e,this.y=t,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},toString:function(){return"{"+this.x+","+this.y+"}"}};return angular.extend(n,e),angular.extend(n.prototype,t),n;function r(e,t){return new n(e.x-t.x,e.y-t.y)}function o(e,t){return e.x*=t,e.y*=t,e}}])}(),function(){"use strict";angular.module("artisan").factory("Rect",[function(){function e(e,t,n,r){this.x=e||0,this.y=t||0,this.w=n||0,this.h=r||0}var t={mult:r},n={bottom:function(){var e=this.x,t=this.y,n=this.w,r=this.h;return{x:e+n/2,y:t+r}},bottomLeft:function(){var e=this.x,t=this.y,n=(this.w,this.h);return{x:e,y:t+n}},bottomRight:function(){var e=this.x,t=this.y,n=this.w,r=this.h;return{x:e+n,y:t+r}},center:function(){var e=this.x,t=this.y,n=this.w,r=this.h;return{x:e+n/2,y:t+r/2}},clone:function(){return new e(this.x,this.y,this.w,this.h)},copy:function(e){return this.x=e.x,this.y=e.y,this.w=e.w,this.h=e.h,this},expand:function(e){return this.expandRect({x:e,y:e,w:2*e,h:2*e})},expandRect:function(e){return this.x-=e.x||0,this.y-=e.y||0,this.w+=e.w||0,this.h+=e.h||0,this},intersect:function(e){var t=this.x,n=this.y,r=this.w,o=this.h;return!(e.x>t+r||e.x+e.w<t||e.y>n+o||e.y+e.h<n)},left:function(){var e=this.x,t=this.y,n=(this.w,this.h);return{x:e,y:t+n/2}},mult:function(e){return r(this,e)},offset:function(e,t){return this.x+=e,this.y+=t,this},reduce:function(e){return this.offset(-e)},reduceRect:function(e){return this.offsetRect(r(e,-1))},right:function(){var e=this.x,t=this.y,n=this.w,r=this.h;return{x:e+n,y:t+r/2}},setH:function(e){return this.h=e,this},setPos:function(e,t){return this.x=e,this.y=t,this},setSize:function(e,t){return this.w=e,this.h=t,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setW:function(e){return this.w=e,this},top:function(){var e=this.x,t=this.y,n=this.w;this.h;return{x:e+n/2,y:t}},topLeft:function(){var e=this.x,t=this.y;this.w,this.h;return{x:e,y:t}},topRight:function(){var e=this.x,t=this.y,n=this.w;this.h;return{x:e+n,y:t}},toString:function(){return"{"+this.x+","+this.y+","+this.w+","+this.h+"}"}};return angular.extend(e,t),angular.extend(e.prototype,n),e;function r(e,t){return e.x*=t,e.y*=t,e.w*=t,e.h*=t,e}}])}(),function(){"use strict";angular.module("artisan").factory("Vector",function(){function n(e,t){this.x=e||0,this.y=t||0}var e={cross:r,difference:o,distance:i,incidence:a,make:function(e,t){return new n(t.x-e.x,t.y-e.y)},normalize:s,power:function(e,t){var n=Math.abs(t.x-e.x),r=Math.abs(t.y-e.y);return(n+r)/2},size:u},t={add:function(e){return this.x+=e.x,this.y+=e.y,this},copy:function(e){return new n(this.x,this.y)},cross:function(e){return r(this,e)},difference:function(e){return o(this,e)},distance:function(e){return i(this,e)},friction:function(e){return this.x*=e,this.y*=e,this},incidence:function(e){return a(this,e)},normalize:function(){return s(this)},power:function(){return(Math.abs(this.x)+Math.abs(this.y))/2},size:function(){return u(this)},towards:function(e,t){return t=t||.125,this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this},toString:function(){return"{"+this.x+","+this.y+"}"}};return angular.extend(n,e),angular.extend(n.prototype,t),n;function r(e,t){return e.x*t.y-e.y*t.x}function o(e,t){return new n(e.x-t.x,e.y-t.y)}function i(e,t){return Math.sqrt((e.x-t.x)*(e.x-t.x)+(e.y-t.y)*(e.y-t.y))}function a(e,t){return Math.atan2(t.y,t.x)-Math.atan2(e.y,e.x)}function s(e){var t=n.size(e);return e.x/=t,e.y/=t,e}function u(e){return Math.sqrt(e.x*e.x+e.y*e.y)}})}(),function(){"use strict";angular.module("artisan").factory("Hash",[function(){var t={};function e(e,t){e=e||"id",t=t?o(t):{},Object.defineProperties(this,{key:{value:e,enumerable:!1,writable:!1},pool:{value:t,enumerable:!1,writable:!1},length:{value:0,enumerable:!1,writable:!0}})}var n={has:function(e){return void 0!==this.pool[e]},get:function(e){return this.pool[e]},getItem:function(e){var t=this.key;return e?this.get(e[t]):null},set:function(e){var t=this.pool,n=this.key;return t[e[n]]=e,this.push(e),e},add:function(e){var t=this.getItem(e);if(t)for(var n,r=0,o=Object.keys(e);r<o.length;r++)n=o[r],t[n]=e[n];else t=this.set(e);return t},once:function(e,t){var n=this.getItem(e);n||(n=this.set(e));"function"==typeof t&&t(n);return n},remove:function(e){var t=this.pool,n=this.key,r=this.getItem(e);if(r){var o=this.indexOf(r);-1!==o&&this.splice(o,1),delete t[r[n]]}return this},each:function(e){if(e)for(var t=0;t<this.length;)e(this[t],t),t++;return this},addMany:function(e){if(!e)return this;var t=0;for(;t<e.length;)this.add(e[t]),t++;return this},removeMany:function(e){if(!e)return this;var t=0;for(;t<e.length;)this.remove(e[t]),t++;return this},removeAll:function(){var e,t=this,n=t.key,r=t.pool;t.length;for(;t.length;)e=t.shift(),delete r[e[n]],0;return t},forward:function(r,o){var r=r||this.key;return this.sort(function(e,t){var n=o?e:t;return(o?t:e)[r]-n[r]}),this},backward:function(e){return this.forward(e,!0)},differs:function(e){{if(e.key!==this.key||e.length!==this.length)return!0;for(var t=!1,n=0,r=this.length,o=this.key;t&&n<r;)t=this[n][o]!==e[n][o],n++}},updatePool:function(){var t=this.pool,n=this.key;Object.keys(t).forEach(function(e){delete t[e]}),angular.forEach(this,function(e){t[e[n]]=e})}},r={get:o};return e.prototype=new Array,angular.extend(e.prototype,n),angular.extend(e,r),e;function o(e){return t[e]=t[e]||{}}}])}(),function(){"use strict";angular.module("artisan").factory("$promise",["$q",function(n){function e(e){if("function"!=typeof e)throw"promise resolve callback missing";var t=n.defer();return e(t),t.promise}var t={all:function(e){return n.all(e)}};return angular.extend(e,t),angular.extend(e.prototype,{}),e}])}(),function(){"use strict";angular.module("artisan").factory("State",["$timeout","$rootScope",function(n,e){function t(){this.idle()}var r={busy:function(){var e=this;return!e.isBusy&&(e.isBusy=!0,e.isError=!1,e.isErroring=!1,e.isSuccess=!1,e.isSuccessing=!1,e.errors=[],!0)},classes:function(e){var t=this,n=null;n={ready:t.isReady,busy:t.isBusy,successing:t.isSuccessing,success:t.isSuccess,errorring:t.isErroring,error:t.isError},e&&angular.forEach(e,function(e,t){n[e]=n[t]});return n},enabled:function(){return!this.isBusy&&!this.isErroring&&!this.isSuccessing},error:function(e){console.log("State.error",e);var t=this;t.isBusy=!1,t.isError=!0,t.isErroring=!0,t.isSuccess=!1,t.isSuccessing=!1,t.errors.push(e),n(function(){t.isErroring=!1},2e3)},errorMessage:function(){return this.isError?this.errors[this.errors.length-1]:null},errors:[],idle:function(){var e=this;e.isBusy=!1,e.isError=!1,e.isErroring=!1,e.isSuccess=!1,e.isSuccessing=!1,e.button=null,e.errors=[]},labels:function(e){var t={ready:"submit",busy:"sending",error:"error",success:"success"};e&&angular.extend(t,e);var n=t.ready;this.isBusy?n=t.busy:this.isSuccess?n=t.success:this.isError&&(n=t.error);return n},ready:function(){this.idle(),this.isReady=!0,e.$broadcast("$stateReady",this)},submitClass:function(){var e=this;return{busy:e.isBusy,ready:e.isReady,successing:e.isSuccessing,success:e.isSuccess,errorring:e.isErroring,error:e.isError}},success:function(){var e=this;e.isBusy=!1,e.isError=!1,e.isErroring=!1,e.isSuccess=!0,e.isSuccessing=!0,e.errors=[],n(function(){e.isSuccessing=!1},2e3)}};return angular.extend(t,{}),angular.extend(t.prototype,r),t}])}(),function(){"use strict";var n=function(){var n="transform",r=document.createElement("DIV");void 0!==r.style[n]?["webkit","moz","o","ms"].every(function(e){var t="-"+e+"-transform";return void 0===r.style[t]||(n=t,!1)}):n=void 0!==r.style.webkitTransform?"-webkit-transform":void 0;return n}();angular.module("artisan").factory("Style",[function(){function e(){this.props={scale:1,hoverScale:1,currentScale:1}}var t={set:function(e){var t=[];for(var n in this)"props"!==n&&t.push(n+":"+this[n]);e.style.cssText=t.join(";")+";"},transform:function(e){this[n]=e},transformOrigin:function(e,t){this[n+"-origin-x"]=Math.round(1e3*e)/1e3+"%",this[n+"-origin-y"]=Math.round(1e3*t)/1e3+"%"}};return angular.extend(e,{}),angular.extend(e.prototype,t),e}])}(),function(){"use strict";angular.module("artisan").service("Utils",["$compile","$controller","Vector",function(s,u,e){var t={compileController:function(e,t,n,r){t.html(n);var o=s(t.contents());if(r.controller){var i=e.$new();angular.extend(i,r);var a=u(r.controller,{$scope:i});r.controllerAs&&(e[r.controllerAs]=a),t.data("$ngControllerController",a),t.children().data("$ngControllerController",a),e=i}o(e)},extract:function(e,t){return Object.keys(e)[Object.values(e).indexOf(t)]},format:function(e,n,r){n=n||"";var t=(e=e||"").split(",");{if(1<t.length){var o=t.shift();return angular.forEach(t,function(e,t){o=r?o.split("{"+t+"}").join("' + "+n+e+" + '"):o.split("{"+t+"}").join(n+e)}),r?"'"+o+"'":o}return n+e}},indexOf:function(e,t,n){n=n||"id";var r=-1;if(e)for(var o=0,i=e.length;o<i;){if(e[o]&&e[o][n]===t[n]){r=o;break}o++}return r},reducer:function(e,t){return e[t]},reducerAdder:function e(t,n,r){return"string"==typeof n?e(t,n.split("."),r):1==n.length&&void 0!==r?t[n[0]]+=r:0===n.length?t:e(t[n[0]],n.slice(1),r)},reducerSetter:function e(t,n,r){return"string"==typeof n?e(t,n.split("."),r):1==n.length&&void 0!==r?t[n[0]]=r:0===n.length?t:e(t[n[0]],n.slice(1),r)},removeValue:function(e,t){var n=-1;if(e)for(var r=0,o=e.length;r<o;){if(e[r]===t){n=r;break}r++}return-1!==n?(e.splice(n,1),t):null},reverseSortOn:function(n){return function(e,t){return e[n]<t[n]?1:e[n]>t[n]?-1:0}},throttle:function(n,r,o){var i,a,s,u=null,c=0;o||(o={});var l=function(){c=!1===o.leading?0:f(),u=null,s=n.apply(i,a),u||(i=a=null)};return function(){var e=f();c||!1!==o.leading||(c=e);var t=r-(e-c);return i=this,a=arguments,t<=0||r<t?(u&&(clearTimeout(u),u=null),c=e,s=n.apply(i,a),u||(i=a=null)):u||!1===o.trailing||(u=setTimeout(l,t)),s}},toMd5:function(e){},where:function(e,t){var o=null;e&&angular.forEach(e,function(n){var r=!0;angular.forEach(t,function(e,t){r=r&&n[t]===e}),r&&(o=n)});return o}};angular.extend(this,t);var f=Date.now||function(){return(new Date).getTime()}}]),"function"!=typeof Array.prototype.reduce&&Object.defineProperty(Array.prototype,"reduce",{value:function(e){if(null===this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof e)throw new TypeError(e+" is not a function");var t,n=Object(this),r=n.length>>>0,o=0;if(2==arguments.length)t=arguments[1];else{for(;o<r&&!(o in n);)o++;if(r<=o)throw new TypeError("Reduce of empty array with no initial value");t=n[o++]}for(;o<r;)o in n&&(t=e(t,n[o],o,n)),o++;return t}}),"function"!=typeof Object.values&&Object.defineProperty(Object,"values",{value:function(e){var t=[];for(var n in e)has(e,n)&&isEnumerable(e,n)&&t.push(e[n]);return t}})}(),function(){"use strict";angular.module("artisan").provider("environment",["$locationProvider","$httpProvider",function(e,t){var n={add:function(e,t){i[e]=i[e]?angular.merge(i[e],t):t,function(){a=angular.copy(r),i.environment&&angular.merge(a,i.environment);var e=function(){for(var e in i){var t=i[e];if(t.paths&&-1!==window.location.href.indexOf(t.paths.app))return t}}();e&&angular.merge(a,e);angular.merge(a,o),s(),u()}()},use:function(e){i[e]&&(a=angular.copy(r),angular.merge(a,i[e]),angular.merge(a,o),s(),u())}};angular.extend(this,n);var r={plugins:{facebook:{fields:"id,name,first_name,last_name,email,gender,picture,cover,link",scope:"public_profile, email",version:"v2.10"},google:{},googlemaps:{clusterer:!0,styles:"/googlemaps/applemapesque.json",options:{center:{lat:43.9023386,lng:12.8505094},disableDefaultUI:!0,mapTypeId:"roadmap",scrollwheel:!0,zoom:4}},mapbox:{clusterer:!0,options:{bearing:0,center:[12.8505094,43.9023386],curve:1,pitch:0,speed:1.5,zoom:4},version:"v0.42.0"}},http:{interceptors:[],withCredentials:!1},language:{code:"en",culture:"en_US",iso:"ENU",name:"English"},location:{hash:"!",html5:!1},paths:{}},o={};window.environment&&angular.merge(o,window.environment);var i={},a=angular.copy(r);function s(){t.defaults.headers.common["Accept-Language"]=a.language.code,t.defaults.withCredentials=a.http.withCredentials,t.interceptors.push.apply(t.interceptors,a.http.interceptors)}function u(){e.html5Mode(a.location.html5),e.hashPrefix(a.location.hash)}angular.merge(a,o),this.$get=function(){return a}}])}(),function(){"use strict";angular.module("artisan").factory("Doc",["Api","$promise",function(e,t){function n(e){e&&angular.extend(this,e)}return angular.extend(n,{}),angular.extend(n.prototype,{}),n}])}(),function(){"use strict";angular.module("artisan").factory("Route",["$promise","$location","$route","$routeParams","Router",function(e,n,t,r,o){function i(e){var t={controller:e.$$route.controller,params:e.params,path:n.path(),pathParams:e.pathParams,originalPath:e.$$route.originalPath,templateUrl:e.loadedTemplateUrl};angular.extend(this,t)}var a={current:function(){return new i(t.current)}};return angular.extend(i,a),angular.extend(i.prototype,{}),i}])}(),function(){"use strict";angular.module("artisan").factory("View",["Api","$promise","environment","Doc","Route",function(t,e,r,i,n){function a(e,t){var n={doc:e,environment:r,route:t};angular.extend(this,n)}var o={current:function(){return e(function(r){var o=n.current(),e=o.path;console.log("ViewCurrent",e),t.docs.path(e).then(function(e){var t=new i(e),n=new a(t,o);r.resolve(n)},function(e){r.reject(e)})})}};return angular.extend(a,o),angular.extend(a.prototype,{}),a}])}(),function(){"use strict";angular.module("artisan").service("AuthService",["$q","$rootScope","$location","LocalStorage","environment",function(o,i,a,s,e){var t={isAuthorizedOrGoTo:function(e){var t=o.defer(),n=s.get("authorization");n&&n.created_at+n.expires_in<(new Date).getTime()?t.resolve(n):(t.reject({status:"unauthorized"}),a.path(e));return t.promise},isAuthorized:function(){var e=s.get("authorization");return e&&e.created_at+e.expires_in<(new Date).getTime()},request:function(e){var t=s.get("authorization");t&&t.created_at+t.expires_in<(new Date).getTime()&&(e.headers=e.headers||{},e.headers.Authorization="Bearer "+t.access_token);return e},response:function(e){return e||o.when(e)},responseError:function(e){switch(console.log("AuthService.responseError",e),e.status){case 400:var t=[];if(e.data)for(var n in t.push(e.data.Message),e.data.ModelState)for(var r=0;r<e.data.ModelState[n].length;r++)t.push(e.data.ModelState[n][r]);else t.push("Server error");e.Message=t.join(" "),i.httpError=e,i.$broadcast("onHttpInterceptorError",e);break;case 404:e.Message="Not found",i.httpError=e,i.$broadcast("onHttpInterceptorError",e);break;case 500:i.httpError=e,i.$broadcast("onHttpInterceptorError",e);break;case 401:s.delete("authorization"),s.delete("user"),a.path("/signin");break;case-1:window.open(e.config.path,"_blank")}return o.reject(e)},signOut:function(){s.delete("authorization"),s.delete("user"),s.delete("CampagnoloToken"),s.delete("GoogleToken"),s.delete("StravaToken"),s.delete("FacebookToken"),s.delete("GarminToken")}};angular.extend(this,t),console.log(e.plugins)}])}(),function(){"use strict";angular.module("artisan").service("Bearer",["$http","$promise","SessionStorage","LocalStorage","environment",function(r,e,o,i,t){var n={delete:function(e,t){o.delete("accessToken"),i.delete("accessToken"),delete r.defaults.headers.common.Authorization},exist:function(e,t){return o.exist("accessToken")||i.exist("accessToken")},get:function(e,t){var e=null;o.exist("accessToken")?a(e=o.get("accessToken")):i.exist("accessToken")&&a(e=i.get("accessToken"));return e},set:a};function a(e,t){var n="Bearer "+e;return delete r.defaults.headers.common.Authorization,r.defaults.headers.common.Authorization=n,o.set("accessToken",e),t&&i.set("accessToken",e),n}angular.extend(this,n)}])}(),function(){"use strict";angular.module("artisan").service("Http",["$http","$promise","$timeout","environment",function(o,r,i,t){var e={get:function(e){return a("get",n(e))},post:function(e,t){return a("post",n(e),t)},put:function(e,t){return a("put",n(e),t)},patch:function(e,t){return a("patch",n(e),t)},delete:function(e){return a("delete",n(e))},static:function(e){return a("get",e)},fake:function(t,n){return n=n||1e3,r(function(e){i(function(){e.resolve({data:t})},n)})}};function n(e){return t.paths.api+e}function a(e,t,n){return r(function(r){o[e](t,n).then(function(e){r.resolve(e.data)},function(e,t){var n=e&&e.data?e.data:{};n.status=e.status,r.reject(n)})})}angular.extend(this,e)}])}(),function(){"use strict";angular.module("artisan").factory("Preload",["$promise",function(s){function u(e){this.path=e,this.loaded=0,this.total=0,this.progress=0}var e={all:function(i,a){return s(function(t){var n=i.map(function(e){return new u(e)}),r={loaded:0,total:0,progress:0,preloads:n},e=setInterval(o,100);function o(){r.loaded=0,r.total=0,angular.forEach(n,function(e){r.loaded+=e.loaded,r.total+=e.total});var e=r.total?r.loaded/r.total:0;e>r.progress&&(r.progress=e,a&&a(r))}s.all(n.map(function(e){return e.start()})).then(function(){clearInterval(e),o(),t.resolve(n.slice())},function(e){t.reject(e)})})}},t={start:function(){var n=this;return s(function(t){var e=new XMLHttpRequest;e.open("GET",n.path,!0),e.responseType="arraybuffer",e.onloadstart=function(e){},e.onprogress=function(e){n.loaded=e.loaded,n.total=e.total,n.progress=e.total?e.loaded/e.total:0},e.onloadend=function(e){n.loaded=n.total,n.progress=1},e.onload=function(){n.buffer=e.response,t.resolve(n)},e.onerror=function(e){console.log("Preload.xhr.onerror",e),n.loaded=n.total,n.progress=1,t.reject(e)},e.send(),n.xhr=e})},image:function(){var e=new Blob([this.buffer]),t=new Image;return t.src=window.URL.createObjectURL(e),t}};return angular.extend(u,e),angular.extend(u.prototype,t),u}])}(),function(){"use strict";angular.module("artisan").service("$once",["$promise",function(e){var t={load:function(e,t){{if(e.indexOf(".js"))return n(e,t);if(e.indexOf(".css"))return r(e)}},script:n,link:r};angular.extend(this,t);var s={},u=0;function n(i,a){return e(function(t){try{var e=s[i]=s[i]||++u;if(e="OnceScript"+e,document.getElementById(e))t.reject();else{var n=document.getElementsByTagName("script"),r=n[n.length-1],o=document.createElement("script");o.id=e,a?(!0===a&&(a=e,i=i.split("{{callback}}").join(a)),window[a]=function(e){t.resolve(e)}):o.addEventListener("load",t.resolve),o.addEventListener("error",t.reject),o.src=i,r.parentNode.insertBefore(o,r.nextSibling)}}catch(e){t.reject(e)}})}function r(i){return e(function(t){try{var e=s[i]=s[i]||++u;if(e="OnceStyle"+e,document.getElementById(e))t.resolve();else{var n=document.getElementsByTagName("link"),r=n[n.length-1],o=document.createElement("link");o.id=e,o.rel="stylesheet",o.href=i,o.addEventListener("load",t.resolve),o.addEventListener("error",t.reject),r.parentNode.insertBefore(o,r.nextSibling)}}catch(e){t.reject(e)}})}}])}(),function(){"use strict";angular.module("artisan").service("Router",["$rootScope","$location","$route","$timeout",function(e,n,t,r){var o,i,a,s,u=this,c={isController:function(e){return s===e},redirect:function(e,t){t?r(function(){f(e)},t):f(e)},path:function(e,t){t?r(function(){h(e)},t):h(e)},apply:function(e,t){t?r(function(){n.path(e)},t):r(function(){n.path(e)})}};function l(){o?o.controller:null,s=i?i.controller:null,a?a.controller:null}function f(e){n.$$lastRequestedPath=n.path(),n.path(e)}function h(e){e=n.$$lastRequestedPath||e,n.$$lastRequestedPath=null,n.path(e)}angular.extend(u,c),e.$on("$routeChangeStart",function(e,t,n){o=null,i=n?n.$$route:null,a=t?t.$$route:null,l(),u.loading=!0}),e.$on("$routeChangeSuccess",function(e,t,n){o=n?n.$$route:null,i=t?t.$$route:null,a=null,l()}),e.$on("$routeChangeError",function(e,t,n,r){o=null,i=n.$$route||null,a=null,l()}),e.$on("$routeUpdate",function(e,t){o=t?t.$$route:null,i=t?t.$$route:null,a=null,l()}),e.$on("$stateReady",function(e,t){r(function(){u.loading=!1},1e3)})}])}(),function(){"use strict";angular.module("artisan").service("Silent",["$rootScope","$location",function(t,r){var o,e={silent:function(e,t){var n=r.url(e);t&&n.replace();o=r.path()},path:function(e){return r.path(e)}};angular.extend(this,e),t.$$listeners.$locationChangeSuccess.unshift(function(e){o===r.path()&&(n=t.$$listeners.$locationChangeSuccess,angular.forEach(n,function(e,t){e!==listener&&(n[t]=function(){n[t]=e})}));var n;o=null})}])}(),function(){"use strict";var e=angular.module("artisan");e.service("Cookie",["$promise",function(e){var t={TIMEOUT:3e5,delete:function(e){i(e,"",-1)},exist:function(e){return-1!==document.cookie.indexOf(";"+e+"=")||0===document.cookie.indexOf(e+"=")},get:s,on:function(a){return e(function(n){var r=1e3,o=0,i=Cookie.TIMEOUT;!function e(){if(i<o)n.reject("timeout");else{var t=s(a);t?n.resolve(t):(o+=r,setTimeout(e,r))}}()})},set:function(t,n,e){try{var r=[],o=JSON.stringify(n,function(e,t){if("pool"!==e){if("object"==typeof t&&null!==t){if(-1!==r.indexOf(t))return;r.push(t)}return t}});r=null,i(t,btoa(encodeURIComponent(o)),e)}catch(e){console.log("CookieSet.error serializing",t,n,e)}}};function s(e){for(var t=e+"=",n=document.cookie.split(";"),r=0;r<n.length;r++){for(var o=n[r];" "==o.charAt(0);)o=o.substring(1,o.length);if(0===o.indexOf(t)){var i=o.substring(t.length,o.length),a=null;try{a=JSON.parse(decodeURIComponent(atob(i)))}catch(e){console.log("Cookie.get.error parsing",key,e)}return a}}return null}function i(e,t,n){var r;if(n){var o=new Date;o.setTime(o.getTime()+24*n*60*60*1e3),r="; expires="+o.toGMTString()}else r="";document.cookie=e+"="+t+r+"; path=/"}angular.extend(this,t)}]),e.service("LocalStorage",["$promise","Cookie",function(e,t){var n={TIMEOUT:3e5,delete:function(e){window.localStorage.removeItem(e)},exist:function(e){return void 0!==window.localStorage[e]},get:function(t){var e=null;if(void 0!==window.localStorage[t])try{e=JSON.parse(window.localStorage[t])}catch(e){console.log("LocalStorage.get.error parsing",t,e)}return e},on:function(o){return e(function(n){var r,e=t.TIMEOUT;angular.element(window).on("storage",function(e){r&&clearTimeout(r);if(e.originalEvent.key==o)try{var t=JSON.parse(e.originalEvent.newValue);n.resolve(t)}catch(e){console.log("LocalStorage.on.error parsing",o,e),n.reject("error parsing "+o)}}),r=setTimeout(function(){n.reject("timeout")},e)})},set:function(t,n){try{var r=[],e=JSON.stringify(n,function(e,t){if("pool"!==e){if("object"==typeof t&&null!==t){if(-1!==r.indexOf(t))return;r.push(t)}return t}});r=null,window.localStorage.setItem(t,e)}catch(e){console.log("LocalStorage.set.error serializing",t,n,e)}}},r=function(){var t=!1;try{(t="localStorage"in window&&null!==window.localStorage)?(window.localStorage.setItem("test","1"),window.localStorage.removeItem("test")):t=!1}catch(e){t=!1}return t}();r?angular.extend(this,n):angular.extend(this,t),this.supported=r}]),e.service("SessionStorage",["$promise","Cookie",function(e,t){var n={TIMEOUT:3e5,delete:function(e){window.sessionStorage.removeItem(e)},exist:function(e){return void 0!==window.sessionStorage[e]},get:function(t){var e=null;if(void 0!==window.sessionStorage[t])try{e=JSON.parse(window.sessionStorage[t])}catch(e){console.log("SessionStorage.get.error parsing",t,e)}return e},on:function(o){return e(function(n){var r,e=t.TIMEOUT;angular.element(window).on("storage",function(e){r&&clearTimeout(r);if(e.originalEvent.key===o)try{var t=JSON.parse(e.originalEvent.newValue);n.resolve(t)}catch(e){console.log("SessionStorage.on.error parsing",o,e),n.reject("error parsing "+o)}}),r=setTimeout(function(){n.reject("timeout")},e)})},set:function(t,n){try{var r=[],e=JSON.stringify(n,function(e,t){if("pool"!==e){if("object"==typeof t&&null!==t){if(-1!==r.indexOf(t))return;r.push(t)}return t}});r=null,window.sessionStorage.setItem(t,e)}catch(e){console.log("SessionStorage.set.error serializing",t,n,e)}}},r=function(){var t=!1;try{(t="sessionStorage"in window&&void 0!==window.sessionStorage)?(window.sessionStorage.setItem("test","1"),window.sessionStorage.removeItem("test")):t=!1}catch(e){t=!1}return t}();r?angular.extend(this,n):angular.extend(this,t),this.supported=r}])}(),function(){"use strict";angular.module("artisan").service("Trust",["$sce",function(t){var e={html:function(e){return n(e,function(){return t.trustAsHtml(e)})},resource:function(e){return n(e,function(){return t.trustAsResourceUrl(e)})},url:function(e){return n(e,function(){return"url('"+e+"')"})}};angular.extend(this,e);var s=[],u=[];function n(e,t){var n,r,o,i,a=(n=e,-1!==(r=s.indexOf(n))?u[r]:null);return a||(a=t(),o=e,i=a,s.push(o),s.push(i)),a}}])}(),function(){"use strict";angular.module("artisan").service("FacebookService",["$promise","$once","LocalStorage","environment",function(e,n,r,o){var i=this,t={require:function(){return u()},login:l,logout:function(){return e(function(t){u().then(function(e){e.logout(function(e){t.resolve(e)})})})},status:c,getMe:function(t){return t=t||a.fields,e(function(n){l().then(function(e){window.FB.api("/me",{fields:t},function(e){if(!e||e.error){var t=e?e.error:"error";console.log("FacebookGetMe.error",t),n.reject(t)}else console.log("FacebookGetMe.success",e),n.resolve(e)})})})},getMyPicture:function(t){return t=t||300,e(function(n){l().then(function(e){window.FB.api("/me/picture",{width:t,height:t,type:"square"},function(e){if(!e||e.error){var t=e?e.error:"error";console.log("FacebookGetMyPicture.error",t),n.reject(t)}else console.log("FacebookGetMyPicture.success",e),n.resolve(e)})})})}};angular.extend(i,t),o.plugins.facebook||trhow("FacebookService.error missing config object in environment.plugins.facebook");var a=o.plugins.facebook,s=r.get("facebook");function u(){return e(function(t){void 0!==window.FB?t.resolve(window.FB):e(function(t){n.script("//connect.facebook.net/"+o.language.culture+"/sdk.js","fbAsyncInit").then(function(){window.FB.init({appId:a.appId,status:!0,cookie:!0,xfbml:!0,version:a.version}),t.resolve(window.FB)},function(e){t.reject(e)})}).then(function(e){t.resolve(window.FB)},function(e){t.reject(e)})})}function c(e,t,n){i.authResponse=null,"connected"===e.status?(i.authResponse=e.authResponse,r.set("facebook",e.authResponse),t.resolve(e)):"not_authorized"===e.status?(r.delete("facebook"),n?t.resolve(e):t.reject(e)):t.reject(e)}function l(){return e(function(t){u().then(function(e){console.log("FacebookLogin",e),e.login(function(e){c(e,t)},{scope:a.scope})})})}console.log("facebook.storage",s)}])}(),function(){"use strict";angular.module("artisan").service("GoogleService",["$timeout","$promise","$once","LocalStorage","environment",function(n,e,r,o,i){var t={require:function(){return l()},login:h,logout:function(){return e(function(t){f().then(function(){s.isSignedIn&&s.isSignedIn.get()?s.signOut().then(function(e){t.resolve()},function(e){console.log("GoogleService.signOut.error",e),t.reject(e)}):t.resolve()},function(e){console.log("GoogleService.signOut.error",e),t.reject(e)})})},getMe:function(){return e(function(r){h().then(function(e){var t=s.currentUser.get().getBasicProfile(),n={id:t.getId(),name:t.getName(),firstName:t.getGivenName(),lastName:t.getFamilyName(),picture:t.getImageUrl(),email:t.getEmail()};console.log("GoogleGetMe.success",n),r.resolve(n)},function(e){console.log("GoogleGetMe.error",e),r.reject(e)})})}};angular.extend(this,t),i.plugins.google||trhow("GoogleService.error missing config object in environment.plugins.google");i.plugins.google;var a=null,s=null,u=o.get("google");function c(){return e(function(t){void 0!==window.gapi?t.resolve(window.gapi):e(function(t){r.script("https://apis.google.com/js/api:client.js?onload={{callback}}",!0).then(function(e){t.resolve(e)},function(e){t.reject(e)})}).then(function(e){t.resolve(window.gapi)},function(e){t.reject(e)})})}function l(){return e(function(t){a?t.resolve(a):c().then(function(){function e(){window.gapi.auth2.init({client_id:i.plugins.google.clientId,cookiepolicy:"single_host_origin",scope:"profile email",fetch_basic_profile:!0,ux_mode:"popup"}).then(function(){a=window.gapi.auth2,console.log("Auth2Init.success",a),t.resolve(a)},function(e){console.log("Auth2Init.error",e),t.reject(e)})}window.gapi.auth2?e():window.gapi.load("auth2",function(){n(function(){e()},200)})},function(e){console.log("Auth2Init.error",e),t.reject(e)})})}function f(){return e(function(t){s?t.resolve():l().then(function(e){s=e.getAuthInstance(),console.log("GoogleService.Auth2Instance.success",s),t.resolve()},function(e){console.log("GoogleService.Auth2Instance.error",e),t.reject(e)})})}function h(){return e(function(n){f().then(function(){function t(){console.log("GoogleLogin.readAccessToken");try{var e=s.currentUser.get().getAuthResponse(!0);console.log("GoogleLogin.readAccessToken.success",e),o.set("google",e),n.resolve({code:e.access_token})}catch(e){console.log("GoogleLogin.readAccessToken.error",e),o.delete("google"),n.reject(e)}}s.isSignedIn&&s.isSignedIn.get()?t():(console.log("GoogleLogin.signIn"),s.signIn({scope:"profile email"}).then(function(e){t()},function(e){console.log("GoogleLogin.error",e),o.delete("google"),n.reject(e)}))},function(e){console.log("GoogleLogin.error",e)})})}console.log("google.storage",u)}])}(),function(){"use strict";angular.module("artisan").directive("googlemaps",["$timeout","$compile","$promise","Http","GoogleMaps","environment",function(l,f,h,d,g,e){var t={restrict:"A",scope:{connector:"=googlemaps"},link:function(o,r,e){var i,a,s;console.log("GooglemapsLink",arguments);var n={},u=[],t={setMarkers:function(t){c().then(function(e){angular.forEach(u,function(e){e.setMap(null)}),s=new google.maps.LatLngBounds,u=t.filter(function(e){var t=!0;return n.month&&(t=t&&n.month.items.has(e.id)),n.category&&(t=t&&-1!==e.categories.indexOf(n.category.key)),t}).map(function(e){return t=e,n=new google.maps.LatLng(t.position.latitude,t.position.longitude),(r=new google.maps.Marker({position:n,item:t,icon:{url:"img/maps/marker.png",scaledSize:new google.maps.Size(25,25),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(0,0)},map:i,contentString:'<div id="iw-container"><div class="iw-image" ng-style="{ \'background-image\': cssUrl(selectedBlog.image.url) }"></div><div class="iw-title" ng-bind="selectedBlog.title"></div><div class="iw-cta"><button type="button" class="iw-link" ng-click="openBlog(selectedBlog)">Details</button></div></div>'})).onClick=function(){var t=this;l(function(){o.selectedBlog=t.item;var e=f(t.contentString)(o);a.setContent(e[0]),a.open(i,t)})},r.addListener("click",r.onClick),s.extend(n),r;var t,n,r}),m.clusterer&&new MarkerClusterer(i,u,{cssClass:"cluster",imagePath:"/img/gmap/m"})})},setType:function(e){-1!==["hybrid","roadmap","satellite","terrain"].indexOf(e)&&i.setMapTypeId(e)}};o.connector&&angular.extend(o.connector,t);function c(){return h(function(n){g.maps().then(function(){h(function(t){var n=angular.copy(m.options);m.styles?d.get(m.styles).then(function(e){n.styles=e,t.resolve(n)},function(e){console.log("GooglemapsOptions.error","unable to load styles",m.styles),t.resolve(n)}):t.resolve(n)}).then(function(e){var t;i=new google.maps.Map(r[0],e),t=new google.maps.InfoWindow({maxWidth:350,pixelOffset:new google.maps.Size(0,15)}),google.maps.event.addListener(t,"domready",function(){var e=$(".gm-style-iw"),t=e.prev();t.children(":nth-child(2)").css({display:"none"}),t.children(":nth-child(4)").css({display:"none"}),e.parent().parent().css({left:"115px"}),t.children(":nth-child(1)").attr("style",function(e,t){return t+"display: none!important"}),t.children(":nth-child(3)").attr("style",function(e,t){return t+"display: none!important"}),t.children(":nth-child(3)").find("div").children().attr("style",function(e,t){return t+"opacity: 0!important;"});var n=e.next();n.css({width:"13px",height:"13px",overflow:"hidden",position:"absolute",right:"56px",top:"17px","z-index":"10000",cursor:"pointer",opacity:1,transform:"scale(0.8)"}),n.mouseout(function(){$(this).css({opacity:"1"})})}),a=t,n.resolve(i)})})})}c()}};e.plugins.googlemaps||trhow("googlemaps.error missing config object in environment.plugins.googlemaps");var m=e.plugins.googlemaps;return t}])}(),function(){"use strict";angular.module("artisan").service("GoogleMaps",["$promise","$once","environment",function(e,n,r){var t={maps:o,geocoder:function(){return e(function(n){o().then(function(e){var t=new e.Geocoder;n.resolve(t)},function(e){n.reject(e)})})},parse:function(e){var t=null;e.length&&(t=e.filter(function(e){return!0}).map(function(e){return{name:e.formatted_address,street:i("street",e),number:i("number",e),locality:i("locality",e),postalCode:i("postalCode",e),city:i("city",e),province:i("province",e),region:i("region",e),country:i("country",e),position:{lng:e.geometry.location.lng(),lat:e.geometry.location.lat()}}}));return console.log("GoogleMapsParse",e,t),t}};function o(){return e(function(t){var e=r.plugins.googlemaps.apiKey;n.script("https://maps.googleapis.com/maps/api/js?key="+e+"&callback={{callback}}",!0).then(function(e){t.resolve(window.google.maps)},function(e){t.reject(e)})})}function i(n,e){var r={street:"route",number:"street_number",locality:"locality",postalCode:"postal_code",city:"administrative_area_level_3",province:"administrative_area_level_2",region:"administrative_area_level_1",country:"country"},o=null;return angular.forEach(e.address_components,function(t){angular.forEach(t.types,function(e){e===r[n]&&(o=t.long_name)})}),o}angular.extend(this,t),r.plugins.googlemaps||trhow("GoogleMaps.error missing config object in environment.plugins.googlemaps")}])}(),function(){"use strict";var e=angular.module("artisan");e.directive("mapbox",["$http","$timeout","$compile","$promise","MapBox","environment",function(e,t,c,l,f,n){var r={restrict:"A",scope:{connector:"=mapbox"},link:function(i,n,e,t){var a,r,o={fly:s,flyPosition:function(e){s(u({center:[e.lng,e.lat],zoom:20}))},jump:function(e){a.jumpTo(e)},jumpPosition:function(e){var t=u({center:[e.lng,e.lat],zoom:20});a.MapboxJump(t)},setMarkers:function(t){l(function(t){f.get().then(function(e){a=new e.Map({container:n[0],style:h.style,interactive:!0,logoPosition:"bottom-right"}),a.getCanvasContainer(),h.options&&a.jumpTo(h.options),t.resolve(a)})}).then(function(){var e;r&&angular.forEach(r,function(e){e.remove()}),r=[],h.clusterer?(e=function(e){var t=null;if(e){var n=e.map(function(e){return{type:"Feature",properties:angular.extend({},e),geometry:{type:"Point",coordinates:function(e){var t=null;e.position&&(t=[e.position.longitude,e.position.latitude,e.position.altitude||0]);return t}(e)}}});t={type:"FeatureCollection",crs:{type:"name",properties:{name:"urn:ogc:def:crs:OGC:1.3:CRS84"}},features:n}}return t}(t),a.on("load",function(){a.addSource("earthquakes",{type:"geojson",data:e,cluster:!0,clusterMaxZoom:14,clusterRadius:50}),a.addLayer({id:"clusters",type:"circle",source:"earthquakes",filter:["has","point_count"],paint:{"circle-color":{property:"point_count",type:"interval",stops:[[0,"#51bbd6"],[100,"#f1f075"],[750,"#f28cb1"]]},"circle-radius":{property:"point_count",type:"interval",stops:[[0,20],[100,30],[750,40]]}}}),a.addLayer({id:"cluster-count",type:"symbol",source:"earthquakes",filter:["has","point_count"],layout:{"text-field":"{point_count_abbreviated}","text-font":["DIN Offc Pro Medium","Arial Unicode MS Bold"],"text-size":12}}),a.addLayer({id:"unclustered-point",type:"circle",source:"earthquakes",filter:["!has","point_count"],paint:{"circle-color":"#11b4da","circle-radius":4,"circle-stroke-width":1,"circle-stroke-color":"#fff"}})})):t&&angular.forEach(t,function(e){var t=function(t){var e=i.$new(!0);e.item=t;var n=document.createElement("div");n.id="point",n.className="marker "+t.area.code,n.className+=t.type,n.setAttribute("marker","item");var r=new mapboxgl.Marker(n,{offset:[-10,-10]}).setLngLat([t.position.lng,t.position.lat]).addTo(a),o=angular.element(n);return o.on("click",function(e){i.$emit("onMarkerClicked",t)}),c(o)(e),r}(e);r.push(t)})})},fitBounds:function(){void 0}};i.connector&&angular.extend(i.connector,o);function s(e){a.flyTo(e)}function u(e){return angular.extend(angular.copy(h.options),e)}}};n.plugins.mapbox||trhow("mapbox.error missing config object in environment.plugins.mapbox");var h=n.plugins.mapbox;return r}]),e.directive("marker",["$http","$timeout",function(e,t){return{restrict:"A",scope:{item:"=marker"},template:'<div class="inner">   <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24">       <path d="M12 0c-5.522 0-10 4.395-10 9.815 0 5.505 4.375 9.268 10 14.185 5.625-4.917 10-8.68 10-14.185 0-5.42-4.478-9.815-10-9.815zm0 18c-4.419 0-8-3.582-8-8s3.581-8 8-8 8 3.582 8 8-3.581 8-8 8z"/>   </svg>   <span ng-bind="item.code"></span></div>',link:function(e,t,n,r){}}}])}(),function(){"use strict";angular.module("artisan").service("MapBox",["$q","$http","$promise","$once","environment",function(e,t,n,r,o){var i={get:function(){return n(function(t){window.mapboxgl?t.resolve(window.mapboxgl):n.all([r.script("//api.tiles.mapbox.com/mapbox-gl-js/"+a.version+"/mapbox-gl.js"),r.link("//api.tiles.mapbox.com/mapbox-gl-js/"+a.version+"/mapbox-gl.css")]).then(function(){window.mapboxgl.accessToken=a.accessToken,t.resolve(window.mapboxgl)},function(e){t.reject(e)})})}};angular.extend(this,i),o.plugins.mapbox||trhow("MapBox.error missing config object in environment.plugins.mapbox");var a=o.plugins.mapbox}])}();
//# sourceMappingURL=artisan.min.js.map
