!function(){"use strict";angular.module("app",["ngSanitize","artisan","jsonFormatter"])}(),function(){"use strict";angular.module("app").service("Api",["Http","Bearer",function(t,e){var o={store:{getById:function(e){return t.get("/store/store.json")}},reserve:{data:function(){return t.get("/reserve/data.json")}},navs:{main:function(){return t.get("/navs/main.json")}},docs:{id:function(e){return t.get("/docs/"+e+".json")},path:function(e){return e=e.split("/").join("-"),t.get("/docs/"+e+".json")}},maps:{markers:function(){return t.get("/maps/markers.json")}}};Object.assign(this,o)}])}(),function(){"use strict";angular.module("app").config(["$locationProvider","$routeProvider","$modalProvider",function(e,t,o){t.when("/reserve",{templateUrl:function(){return"views/reserve.html"},controller:"ReserveController",resolve:{store:function(){return null}}}).when("/reserve/:storeId",{templateUrl:function(){return"views/reserve/reserve.html"},controller:"ReserveController",resolve:{store:["$route","Api",function(e,t){return t.store.getById(e.current.params.storeId)}]}}).when("/reserve/:storeId/planner",{templateUrl:function(){return"views/reserve/planner.html"},controller:"PlannerController",resolve:{store:["$route","Api",function(e,t){return t.store.getById(e.current.params.storeId)}],booking:["BookingService",function(e){return e.currentOrGoTo("/")}]}}).when("/contact-us",{templateUrl:function(){return"views/contact-us.html"},controller:"ContactUsCtrl"}),t.otherwise("/reserve/1"),o.when("categoriesModal",{title:"Categories modal",templateUrl:"views/reserve/modals/categories.html",controller:"CategoriesModal",customClass:""}).when("productsModal",{title:"Products modal",templateUrl:"views/reserve/modals/products.html",controller:"ProductsModal",customClass:""}).when("timesModal",{title:"Times modal",templateUrl:"views/reserve/modals/times.html",controller:"TimesModal",customClass:""})}])}(),function(){"use strict";angular.module("app").run(["$rootScope","$modal","Router","Trust","Bearer",function(e,t,o,n,r){e.modals=t.modals,e.addModal=t.addModal,e.router=o,e.trust=n,e.accessToken=r.get(),console.log("app.run accessToken",e.accessToken)}])}(),function(){"use strict";var e=angular.module("app"),c={categories:[],products:[],daytimes:[],times:[],model:{store:null,category:null,products:null,date:null,daytime:null,time:null}};e.factory("BookingService",["$promise","$location","Api","SessionStorage","environment",function(e,n,t,r,o){function a(e){Object.assign(this,c),e&&(Object.assign(this,e),this.model.store=this.store,this.model.category=this.categories[0],this.model.category.active=!0)}var i={new:function(){return e(function(o){t.reserve.data().then(function(e){var t=new a(e);a.booking=t,r.set("booking",t),o.resolve(t)},function(e){o.reject(e)})})},current:function(){return e(function(e){if(a.booking)e.resolve(a.booking);else if(r.exist("booking")){var t=r.get("booking");a.booking=new a(t),e.resolve(a.booking)}else e.resolve(null)})},currentOrGoTo:function(o){return e(function(t){a.current().then(function(e){e?t.resolve(e):(n.$$lastRequestedPath=n.path(),n.path(o))},function(e){t.reject(e)})})},update:function(){return e(function(e){if(a.booking){var t=a.booking;r.set("booking",t),e.resolve(t)}else e.reject(error)})}},s={getProductsByCategory:function(t){return this.products.filter(function(e){return e.category===t.id}).sort(function(e,t){var o=e.name.toUpperCase(),n=t.name.toUpperCase();return o<n?-1:n<o?1:0})},getTimesByDaytime:function(t){return this.model.daytime=t,this.times.filter(function(e){return e.daytime===t.id}).map(function(e,t){var o=Object.assign({},e);return o.active=0===t,o})},getProductNames:function(){return this.model.products.map(function(e){return e.name}).join(", ")}};return Object.assign(a,i),Object.assign(a.prototype,s),a}])}(),function(){"use strict";angular.module("app").controller("CategoriesModal",["$scope","State","View","Range",function(e,t,o,n){var r=new t,a=e.modal,i=e.params?e.params:[],s={state:r,items:i,onSelect:function(e){i.forEach(function(e){e.active=!1}),e.active=!0},onSubmit:function(){console.log("CategoriesModal.onSubmit"),a.resolve(i.find(function(e){return e.active}))}};Object.assign(e,s),r.ready()}])}(),function(){"use strict";angular.module("app").controller("PlannerController",["$scope","$location","State","BookingService","View","Range","store",function(a,e,t,o,n,r,i){var s=new t,c=null,l=null,u={onMonthDidChange:function(e,t,o){console.log("onMonthDidChange.date",e)},onWeekDidSelect:function(e,t,o){console.log("onWeekDidSelect.week",e)},onDayDidSelect:function(e,t,o,n){console.log("onDayDidSelect.day",e,t,c);var r=c.getTimesByDaytime(t);a.$root.addModal("timesModal",{day:e,daytime:t,times:r}).then(function(e){console.log("timesModal.resolve",e),l.appointment=e},function(e){console.log("timesModal.reject",e)})}},d={state:s,store:i,booking:c,model:l,plannerOptions:u,onBack:function(){e.path("/reserve/"+i.id)},onSubmit:function(){console.log("CalendarController.onSubmit"),s.busy()&&setTimeout(function(){s.success()},50)}};Object.assign(a,d),o.current().then(function(e){l=(c=e).model,a.booking=c,a.model=l,s.ready()},function(e){s.error(e)})}])}(),function(){"use strict";var e=angular.module("artisan");e.directive("planner",["$templateCache","$parse","$q","$timeout","$filter","Hash","DateTime","Range","CalendarFactory","State","Api",function(n,e,t,o,r,a,i,g,m,s,c){return{priority:1002,restrict:"A",templateUrl:function(e,t){var o=t.template;o||(o="partials/planner",n.get(o)||n.put(o,'<div><json-formatter json="options"></json-formatter></div>'));return o},scope:{options:"=planner",daytimes:"=daytimes"},link:function(e,t,o,n,r){var a=new m,i=e.options||{onMonthDidChange:function(){},onWeekDidSelect:function(){},onDayDidSelect:function(){}},s=g.Month(),c=g.Week(),l=g.Day(),u={month:s,week:c,day:l,view:null},d={sources:u,doNavWeek:function(e){p(c.getDate(e))},doNavMonth:function(e){t=s.getDate(e),t&&!s.isOutside(t)||(t&&s.setDate(t),o=t,(n=a.getMonthByDate(s.getDate())).days.each(function(e){var t=e.date.getDay();e.dirty=!0,e.hours=0,e.availableHours=0,e.recordedHours=0,e.selected=u.day.isCurrent(e.date),e.past=e.key<g.today.key,e.weekend=0===t||6===t,e.working=!e.weekend,e.holiday=!1,e.vacation=!1,e.wasVacation=!1,e.wasWorkable=!1,e.workable=!1,e.green=!1,e.orange=!1}),u.view=n,i.onMonthDidChange(o,s,n));var t,o,n},onWeekSelect:function(e){if(!e)return;i.onWeekDidSelect(e,s,u.view)},onDaySelect:function(e,t){if(!e)return;!0===i.onDayDidSelect(e,t,s,u.view)&&(u.day.setDate(e.date),u.view.days.each(function(e){e.selected=u.day.isCurrent(e.date)}))},getDayClasses:function(e){var t={day:e};e&&angular.extend(t,{today:e.$today,selected:e.selected,workable:e.workable,holiday:e.holiday,vacation:e.vacation,working:e.working,available:e.available,full:e.full,"status-green":e.green,"status-orange":e.orange});return t},hasWeeksBefore:function(){return!c.isCurrent(l.date)}};function p(e){var t,o;e&&!c.isOutside(e)||(e&&c.setDate(e),t=e,(o=a.getWeekByDate(c.getDate())).days.each(function(e){var t=e.date.getDay();e.dirty=!0,e.selected=u.day.isCurrent(e.date),e.past=e.key<g.today.key,e.weekend=0===t||6===t,e.working=!e.weekend,e.holiday=!1,e.vacation=!1,e.wasVacation=!1,e.wasWorkable=!1,e.workable=!1}),u.view=o,i.onMonthDidChange(t,s,o))}angular.extend(e,d),p()}}}]),e.filter("capitalize",function(){return function(e){return e?e.charAt(0).toUpperCase()+e.substr(1).toLowerCase():""}})}(),function(){"use strict";angular.module("app").controller("ProductsModal",["$scope","State","View","Range",function(e,t,o,n){var r=new t,a=e.modal,i=e.params?e.params:[],s={state:r,items:i,onSubmit:function(){console.log("ProductsModal.onSubmit"),a.resolve(i.filter(function(e){return e.active}))}};Object.assign(e,s),r.ready()}])}(),function(){"use strict";angular.module("app").controller("ReserveController",["$scope","$location","State","BookingService","View","Range","store",function(t,o,e,n,r,a,i){var s=new e,c=null,l=null,u={state:s,store:i,booking:c,model:l,onSelectCategory:function(){console.log("ReserveController.onSelectCategory"),t.$root.addModal("categoriesModal",c.categories).then(function(e){console.log("categoriesModal.resolve",e),l.category=e,l.products=null},function(e){console.log("categoriesModal.reject",e)})},onSelectProduct:function(){console.log("ReserveController.onSelectProduct");var e=c.getProductsByCategory(l.category);t.$root.addModal("productsModal",e).then(function(e){console.log("productsModal.resolve",e),l.products=e},function(e){console.log("productsModal.reject",e)})},onSubmit:function(){console.log("ReserveController.onSubmit"),s.busy()&&n.update(c).then(function(e){o.path("/reserve/"+i.id+"/planner"),s.success()})}};Object.assign(t,u),n.new().then(function(e){l=(c=e).model,t.booking=c,t.model=l,s.ready()},function(e){s.error(e)})}])}(),function(){"use strict";angular.module("app").controller("TimesModal",["$scope","State","View","Range",function(e,t,o,n){var r=new t,a=e.modal,i=(e.params?e.params:{}).times||[],s={state:r,items:i,onSelect:function(e){i.forEach(function(e){e.active=!1}),e.active=!0},onSubmit:function(){console.log("TimeModal.onSubmit"),a.resolve(i.find(function(e){return e.active}))}};Object.assign(e,s),r.ready()}])}(),function(){"use strict";angular.module("app").controller("ContactUsCtrl",["$scope","State","View","Api",function(t,e,o,n){var r=new e,a=new e,i={},s={},c={state:r,state2:a,googlemaps:i,mapbox:s};Object.assign(t,c),o.current().then(function(e){t.view=e,r.ready()},function(e){r.error(e)}),n.maps.markers().then(function(e){i.setMarkers(e),s.setMarkers(e)})}])}(),function(){"use strict";angular.module("app").controller("RootCtrl",["$scope","$timeout","$promise","Nav","Api","Range","Scrollable","AuthService",function(e,t,o,n,r,a,i,s){var c=new n({onPath:function(e){return e.path},onNav:function(e){return n.path(e.$nav.path),!1}});r.navs.main().then(function(e){c.setItems(e)},function(e){console.log("RootCtrl.error",e)}),e.nav=c;var l=new i;e.scrollable=l}])}(),function(){"use strict";angular.module("app").config(["environmentProvider",function(e){e.add("environment",{http:{interceptors:[],withCredentials:!1},language:{code:"en",culture:"en_US",iso:"ENU",name:"English"},location:{hash:"!",html5:!1},plugins:{facebook:{appId:340008479796111,fields:"id,name,first_name,last_name,email,gender,picture,cover,link",scope:"public_profile, email",version:"v2.10"},google:{apiKey:"AIzaSyCn6O-j_8pipy-ErGxg4bM1juGesiyM28U",clientId:"1063539520533-7308vqmt92em6dv1v5q52fq2or36jk95.apps.googleusercontent.com"},googlemaps:{apiKey:"AIzaSyCn6O-j_8pipy-ErGxg4bM1juGesiyM28U",styles:"/googlemaps/applemapesque.json",options:{center:{lat:43.9023386,lng:12.8505094},zoom:4}},mapbox:{accessToken:"pk.eyJ1IjoiYWN0YXJpYW4iLCJhIjoiY2lqNWU3MnBzMDAyZndnbTM1cjMyd2N2MiJ9.CbuEGSvOAfIYggQv854pRQ",options:{center:[12.8505094,43.9023386],zoom:4},style:"mapbox://styles/actarian/cja82nadj07sn2rmty6n1n5pk",version:"v0.42.0"}}})}])}(),function(){"use strict";angular.module("app").config(["environmentProvider",function(e){e.add("local",{paths:{api:"http://localhost:6001/api",app:"http://localhost:6001"},plugins:{facebook:{appId:340008479796111}}})}])}(),function(){"use strict";angular.module("app").config(["environmentProvider",function(e){e.add("production",{paths:{api:"https://actarian.github.io/artisan/api",app:"https://actarian.github.io/artisan"},plugins:{facebook:{appId:0x8e099954c588}}})}])}(),function(){"use strict";angular.module("app").config(["environmentProvider",function(e){e.add("stage",{})}])}();
//# sourceMappingURL=app.min.js.map
